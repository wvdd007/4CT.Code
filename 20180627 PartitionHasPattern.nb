(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47915,       1458]
NotebookOptionsPosition[     43763,       1350]
NotebookOutlinePosition[     44107,       1365]
CellTagsIndexPosition[     44064,       1362]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Contains12", "[", 
   RowBox[{"s_", ",", "sub_"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Or", ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Intersection", "[", 
          RowBox[{"#", ",", "sub"}], "]"}], "]"}], "\[Equal]", 
        RowBox[{"Length", "[", "sub", "]"}]}], "&"}], ",", 
      RowBox[{"SymbolToSets", "[", "s", "]"}]}], "]"}]}], "]"}]}]], "Input",Ex\
pressionUUID->"50a7c98c-a99d-49a3-8e1b-c3b3f1c3720c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PartitionHasPattern", "[", 
   RowBox[{"p_", ",", "pattern_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "current", ",", " ", "found", ",", " ", "block", ",", "i", ",", "j", ",",
       " ", 
      RowBox[{"all", "=", "p"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"found", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "pattern", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"block", " ", "=", " ", 
         RowBox[{"Sort", "[", 
          RowBox[{"pattern", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"found", "=", " ", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", "all", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"all", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "block"}], "]"}], "]"}],
              "\[Equal]", 
             RowBox[{"Length", "[", "block", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"found", "=", "True"}], ";", "\[IndentingNewLine]", 
             RowBox[{"all", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"all", ",", "j"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"j", "=", 
              RowBox[{
               RowBox[{"Length", "[", "all", "]"}], "+", "1"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "found"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "found", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7389182559879894`*^9, 3.73891836048464*^9}, {
  3.738918391760725*^9, 3.7389185762420177`*^9}, {3.7389186239607115`*^9, 
  3.738918740914453*^9}, {3.7389188624514*^9, 3.738918910611108*^9}, {
  3.7389189422479353`*^9, 3.7389189676177597`*^9}, {3.738919027766071*^9, 
  3.738919030914919*^9}},ExpressionUUID->"2546cf4e-3fd9-40d2-ae79-\
b22bc361afa0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PartitionHasPattern", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7389185803453074`*^9, 3.738918605936677*^9}, {
   3.7389188380869246`*^9, 3.738918844774444*^9}, 3.738918983596201*^9, 
   3.7389191362980905`*^9, {3.738919206412158*^9, 
   3.738919209176942*^9}},ExpressionUUID->"72dae532-4ec9-4692-9264-\
75d5a859ba13"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.738918606643441*^9, {3.738918668378462*^9, 3.7389186880862474`*^9}, 
   3.7389187321790276`*^9, {3.73891884613183*^9, 3.738918985027559*^9}, 
   3.7389190366855764`*^9, 3.738919137118317*^9, 3.738919210053846*^9, 
   3.7389449341408973`*^9},ExpressionUUID->"c9d12822-b77a-46f7-a73b-\
d7aa7f8bacee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KSetPartitions", "[", 
  RowBox[{
   RowBox[{"Range", "[", "6", "]"}], ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.7389187571151466`*^9, 3.738918763571163*^9}, {
  3.7389190591606183`*^9, 
  3.7389190936755123`*^9}},ExpressionUUID->"beae3b7d-2120-4fd3-8dfb-\
e0e2f90f419e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "6", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.73891876430138*^9, {3.738919059923256*^9, 3.738919094268256*^9}, 
   3.7389449341838555`*^9},ExpressionUUID->"1d4039dc-8aac-48ba-9324-\
412dc6182e86"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"Map", "[", 
   RowBox[{"Mean", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7390165249471116`*^9, 3.7390165383047514`*^9}, {
  3.7390688795272045`*^9, 3.739068880149887*^9}, {3.7390689183365912`*^9, 
  3.7390689213847017`*^9}},ExpressionUUID->"130844ab-0d2d-4b7c-80c4-\
3afa444e89fa"],

Cell[BoxData[
 FractionBox["8", "3"]], "Output",
 CellChangeTimes->{{3.7390165329525733`*^9, 3.7390165386716957`*^9}, 
   3.7390688812580385`*^9, 
   3.739068921885398*^9},ExpressionUUID->"a9dd8b14-16a4-4940-b6d1-\
dae3894f33a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"allGraphs5", "[", 
    RowBox[{"k", ",", "\"\<vertexsets\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "alfa1s"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.739068935349794*^9, 
  3.7390689541942973`*^9}},ExpressionUUID->"29144cdb-f22d-4119-a810-\
4e17ebfaa4de"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "5", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7390689552493143`*^9},ExpressionUUID->"8d1b6d79-7032-4c20-aa81-\
085792f77b04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"KSetPartitions", "[", 
       RowBox[{
        RowBox[{"Range", "[", "k", "]"}], ",", "4"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}], ",", 
            RowBox[{"{", "5", "}"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "4"}], "}"}], ",", 
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}], ",", 
            RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "5"}], "}"}], ",", 
            RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}], "&"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "4", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.738918748282417*^9, 3.7389188053102016`*^9}, 
   3.7389190446197386`*^9, 3.738919088037203*^9, {3.7389192241253896`*^9, 
   3.7389192351144447`*^9}, {3.738919446165045*^9, 3.7389194530265713`*^9}, {
   3.738921443137967*^9, 
   3.738921540108894*^9}},ExpressionUUID->"8a4f823d-6cfb-494b-9f5c-\
a7585a277295"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "5", ",", "35", ",", "185", ",", "875", ",", "3905"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.738918806183339*^9, 3.738918916879595*^9, {3.7389190406757183`*^9, 
   3.738919045287402*^9}, 3.738919088912385*^9, {3.7389192156753817`*^9, 
   3.738919236005373*^9}, {3.7389194486843386`*^9, 3.73891945372126*^9}, 
   3.738921513924899*^9, 3.7389215467339034`*^9, 
   3.738944940273596*^9},ExpressionUUID->"8c2faea3-bef9-4154-bced-\
d6b014005556"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FactorInteger", "[", 
  RowBox[{"{", 
   RowBox[{
   "0", ",", "0", ",", "5", ",", "35", ",", "185", ",", "875", ",", "3905"}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.738921582225833*^9, 
  3.738921592230033*^9}},ExpressionUUID->"f232a139-0f96-4cf6-82ad-\
47824800fa8b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"5", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"37", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"71", ",", "1"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.738921592906988*^9, 
  3.73894494035432*^9},ExpressionUUID->"171cfc62-d23a-48c0-8285-2757260bb722"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"KSetPartitions", "[", 
       RowBox[{
        RowBox[{"Range", "[", "k", "]"}], ",", "4"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}], ",", 
            RowBox[{"{", "3", "}"}], ",", 
            RowBox[{"{", "5", "}"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "5"}], "}"}], ",", 
            RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}], ",", 
            RowBox[{"{", "3", "}"}], ",", 
            RowBox[{"{", "5", "}"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "5"}], "}"}], ",", 
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "4", "}"}], ",", 
            RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"PartitionHasPattern", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "5"}], "}"}], ",", 
            RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}], "&"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "4", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7390164026125903`*^9, 
  3.739016436116703*^9}},ExpressionUUID->"1c69c36c-b021-4af5-b3e2-\
829b41f0aed7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsRefinement2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7391033511471977`*^9, 3.739103383307988*^9}, 
   3.7391843903978014`*^9},ExpressionUUID->"b7aa1614-2f2e-495b-99f0-\
fe00298dd198"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.7391033842956495`*^9, 
  3.73918439322971*^9},ExpressionUUID->"6512f9ba-6068-4a28-ad92-1ec9d6ef19f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsRefinement2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7391033918474116`*^9, 3.7391033964265623`*^9}, 
   3.7391843858062644`*^9},ExpressionUUID->"33561d67-4823-4245-8787-\
de6e98036eae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", "1", "}"}]], "Print",
 CellChangeTimes->{
  3.739184457403556*^9},ExpressionUUID->"4e401d31-cbf1-4206-b90f-\
fadf6b8f5a1f"],

Cell[BoxData[
 RowBox[{"{", "2", "}"}]], "Print",
 CellChangeTimes->{
  3.73918445740456*^9},ExpressionUUID->"213a4750-e348-43c5-865c-ebaded4d16d8"]
}, Open  ]],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.73910339724887*^9, 
  3.739184457409972*^9},ExpressionUUID->"b801f23a-ad43-4c66-8ac2-\
df3e90be3c81"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsRefinement2", "[", 
   RowBox[{"sets1_", ",", "sets2_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"result", "=", "True"}], ",", "merged", ",", "allOK", ",", " ", 
      "pos", ",", " ", "bucket"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"pos", "=", "1"}], ",", 
       RowBox[{"pos", "\[LessEqual]", 
        RowBox[{"Length", "[", "sets2", "]"}]}], ",", " ", 
       RowBox[{"pos", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bucket", "=", " ", 
         RowBox[{"sets2", "[", 
          RowBox[{"[", "pos", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"sets1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Intersection", "[", 
                  RowBox[{"#", ",", "bucket"}], "]"}], "]"}], "\[Equal]", 
                RowBox[{"Length", "[", "bucket", "]"}]}], "&"}]}], "]"}], 
            "]"}], "\[NotEqual]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"result", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7391842634736814`*^9, 3.739184380635999*^9}, {
  3.7391844122049913`*^9, 
  3.7391844617732105`*^9}},ExpressionUUID->"80d99d17-9ec3-46d3-82fb-\
a71110ef5605"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountGood", "[", "nodes_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "good4", ",", "all5", ",", "good5", ",", "current", ",", "allLength"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"good4", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"KSetPartitions", "[", 
         RowBox[{
          RowBox[{"Range", "[", "nodes", "]"}], ",", "4"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"PartitionHasPattern", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}], ",", 
              RowBox[{"{", "5", "}"}]}], "}"}]}], "]"}], "||", 
          RowBox[{"PartitionHasPattern", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "4"}], "}"}], ",", 
              RowBox[{"{", "2", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "]"}], "||", 
          RowBox[{"PartitionHasPattern", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "]"}], "||", 
          RowBox[{"PartitionHasPattern", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}], ",", 
              RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}], "||", 
          RowBox[{"PartitionHasPattern", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "5"}], "}"}], ",", 
              RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"all5", "=", 
      RowBox[{"KSetPartitions", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nodes", "]"}], ",", "5"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"good5", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allLength", "=", 
      RowBox[{"Length", "[", "all5", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"current", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"IsRefinement", "[", 
               RowBox[{"four", ",", "five"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"good5", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"good5", ",", "five"}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"four", ",", "good4"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"current", "++"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"five", ",", "all5"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "nodes", ",", "four", ",", "five", ",", "current", ",", "allLength"}],
         "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"nodes", ",", 
       RowBox[{"Length", "[", "good4", "]"}], ",", 
       RowBox[{"Length", "[", 
        RowBox[{"DeleteDuplicates", "[", "good5", "]"}], "]"}], ",", 
       RowBox[{"StirlingS2", "[", 
        RowBox[{"nodes", ",", "4"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7391034166910553`*^9, 3.73910369356959*^9}, {
  3.7391037356454926`*^9, 3.7391037469480376`*^9}, {3.7391039190029173`*^9, 
  3.739103956209983*^9}, {3.7391040657915277`*^9, 3.739104071503459*^9}, {
  3.7391041114863267`*^9, 3.7391041271920567`*^9}, {3.7392133158879395`*^9, 
  3.739213372032645*^9}},ExpressionUUID->"34614e6e-922e-462e-8938-\
367ec1c13e44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"CountGood", "[", "k", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "5", ",", "9"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.739103696713128*^9, 3.739103721009261*^9}, 
   3.7391039250151157`*^9, {3.7391039594103518`*^9, 3.7391039600692115`*^9}, 
   3.739104018135604*^9, 3.73910413814491*^9, {3.7391045440762143`*^9, 
   3.739104544388573*^9}, 3.7391845209724116`*^9, {3.739184730302263*^9, 
   3.7391847474456882`*^9}},ExpressionUUID->"3fd7112d-a72d-4446-9968-\
65c7a298db5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "5", ",", "6", ",", "65"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "35", ",", "59", ",", "350"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "185", ",", "426", ",", "1701"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "875", ",", "2699", ",", "7770"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.739184724357373*^9, 3.739184740555977*^9}, 
   3.739185050148128*^9},ExpressionUUID->"010e2f06-86a1-445b-8c7e-\
01e07fa61486"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"CountGood", "[", "k", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "10", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7391903504914017`*^9, 
  3.7391903524788547`*^9}},ExpressionUUID->"aba535d5-946b-4924-9bdf-\
82ccdec206c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"10", ",", "3905", ",", "15906", ",", "34105"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7391986039580407`*^9},ExpressionUUID->"281557f9-4510-4caa-81bd-\
cc8dccb6457e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"CountGood", "[", "k", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "11", ",", "11"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7392130970974755`*^9, 
  3.7392130991979847`*^9}},ExpressionUUID->"d780f071-0348-408f-a891-\
a5225d45dd54"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.7392133035290775`*^9},ExpressionUUID->"13f7d436-bc04-4a2b-89bb-\
5ab6d9d041b5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"CountGood", "[", "k", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "12", ",", "12"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.739213101414797*^9, 
  3.7392131041036396`*^9}},ExpressionUUID->"c5e70836-eacc-4df4-b66f-\
b86de3f74144"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "/", 
      RowBox[{"#", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "0", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5", ",", "6", ",", "65"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "35", ",", "59", ",", "350"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "185", ",", "426", ",", "1701"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "875", ",", "2699", ",", "7770"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "3905", ",", "15906", ",", "34105"}], "}"}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.73910450318856*^9, 3.7391045260603924`*^9}, {
  3.739213079960266*^9, 
  3.7392130803835793`*^9}},ExpressionUUID->"c9d0a6bc-c80a-4a2f-900a-\
425a10323381"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.09230769230769231`", ",", "0.16857142857142857`", ",", 
   "0.25044091710758376`", ",", "0.3473616473616474`", ",", 
   "0.4663832282656502`"}], "}"}]], "Output",
 CellChangeTimes->{{3.739104516328149*^9, 3.7391045270082865`*^9}, 
   3.7392130810465546`*^9},ExpressionUUID->"d05f3af7-c646-41cb-9703-\
1b1ab9313b62"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"KSetPartitions", "[", 
    RowBox[{
     RowBox[{"Range", "[", "5", "]"}], ",", "4"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"PartitionHasPattern", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}], ",", 
         RowBox[{"{", "5", "}"}]}], "}"}]}], "]"}], "||", 
     RowBox[{"PartitionHasPattern", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "]"}], "||", 
     RowBox[{"PartitionHasPattern", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "]"}], "||", 
     RowBox[{"PartitionHasPattern", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}], "||", 
     RowBox[{"PartitionHasPattern", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "5"}], "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}], "&"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7391039876797523`*^9},ExpressionUUID->"53bf8273-c44b-455b-93e2-\
84c076fbed21"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.7391039883720655`*^9},ExpressionUUID->"8a7c8372-17e4-4239-8aec-\
3404c368be06"]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 545, 15, 30, "Input", "ExpressionUUID" -> \
"50a7c98c-a99d-49a3-8e1b-c3b3f1c3720c"],
Cell[1106, 37, 2765, 65, 316, "Input", "ExpressionUUID" -> \
"2546cf4e-3fd9-40d2-ae79-b22bc361afa0"],
Cell[CellGroupData[{
Cell[3896, 106, 790, 22, 30, "Input", "ExpressionUUID" -> \
"72dae532-4ec9-4692-9264-75d5a859ba13"],
Cell[4689, 130, 354, 6, 30, "Output", "ExpressionUUID" -> \
"c9d12822-b77a-46f7-a73b-d7aa7f8bacee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5080, 141, 304, 7, 30, "Input", "ExpressionUUID" -> \
"beae3b7d-2120-4fd3-8dfb-e0e2f90f419e"],
Cell[5387, 150, 15293, 506, 221, "Output", "ExpressionUUID" -> \
"1d4039dc-8aac-48ba-9324-412dc6182e86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20717, 661, 543, 14, 30, "Input", "ExpressionUUID" -> \
"130844ab-0d2d-4b7c-80c4-3afa444e89fa"],
Cell[21263, 677, 229, 5, 53, "Output", "ExpressionUUID" -> \
"a9dd8b14-16a4-4940-b6d1-dae3894f33a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21529, 687, 343, 9, 30, "Input", "ExpressionUUID" -> \
"29144cdb-f22d-4119-a810-4e17ebfaa4de"],
Cell[21875, 698, 1162, 40, 30, "Output", "ExpressionUUID" -> \
"8d1b6d79-7032-4c20-aa81-085792f77b04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23074, 743, 2377, 64, 107, "Input", "ExpressionUUID" -> \
"8a4f823d-6cfb-494b-9f5c-a7585a277295"],
Cell[25454, 809, 510, 11, 30, "Output", "ExpressionUUID" -> \
"8c2faea3-bef9-4154-bced-d6b014005556"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26001, 825, 305, 8, 30, "Input", "ExpressionUUID" -> \
"f232a139-0f96-4cf6-82ad-47824800fa8b"],
Cell[26309, 835, 1155, 39, 30, "Output", "ExpressionUUID" -> \
"171cfc62-d23a-48c0-8285-2757260bb722"]
}, Open  ]],
Cell[27479, 877, 2210, 61, 107, "Input", "ExpressionUUID" -> \
"1c69c36c-b021-4af5-b3e2-829b41f0aed7"],
Cell[CellGroupData[{
Cell[29714, 942, 418, 12, 30, "Input", "ExpressionUUID" -> \
"b7aa1614-2f2e-495b-99f0-fe00298dd198"],
Cell[30135, 956, 155, 2, 30, "Output", "ExpressionUUID" -> \
"6512f9ba-6068-4a28-ad92-1ec9d6ef19f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30327, 963, 420, 12, 30, "Input", "ExpressionUUID" -> \
"33561d67-4823-4245-8787-de6e98036eae"],
Cell[CellGroupData[{
Cell[30772, 979, 151, 4, 22, "Print", "ExpressionUUID" -> \
"4e401d31-cbf1-4206-b90f-fadf6b8f5a1f"],
Cell[30926, 985, 148, 3, 22, "Print", "ExpressionUUID" -> \
"213a4750-e348-43c5-865c-ebaded4d16d8"]
}, Open  ]],
Cell[31089, 991, 154, 3, 30, "Output", "ExpressionUUID" -> \
"b801f23a-ad43-4c66-8ac2-df3e90be3c81"]
}, Open  ]],
Cell[31258, 997, 1752, 42, 202, "Input", "ExpressionUUID" -> \
"80d99d17-9ec3-46d3-82fb-a71110ef5605"],
Cell[33013, 1041, 4690, 114, 468, "Input", "ExpressionUUID" -> \
"34614e6e-922e-462e-8938-367ec1c13e44"],
Cell[CellGroupData[{
Cell[37728, 1159, 553, 11, 30, "Input", "ExpressionUUID" -> \
"3fd7112d-a72d-4446-9968-65c7a298db5d"],
Cell[38284, 1172, 621, 16, 30, "Output", "ExpressionUUID" -> \
"010e2f06-86a1-445b-8c7e-01e07fa61486"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38942, 1193, 309, 8, 30, "Input", "ExpressionUUID" -> \
"aba535d5-946b-4924-9bdf-82ccdec206c9"],
Cell[39254, 1203, 236, 7, 30, "Output", "ExpressionUUID" -> \
"281557f9-4510-4caa-81bd-cc8dccb6457e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39527, 1215, 309, 8, 30, "Input", "ExpressionUUID" -> \
"d780f071-0348-408f-a891-a5225d45dd54"],
Cell[39839, 1225, 139, 3, 30, "Output", "ExpressionUUID" -> \
"13f7d436-bc04-4a2b-89bb-5ab6d9d041b5"]
}, Open  ]],
Cell[39993, 1231, 307, 8, 30, "Input", "ExpressionUUID" -> \
"c5e70836-eacc-4df4-b66f-b86de3f74144"],
Cell[CellGroupData[{
Cell[40325, 1243, 1017, 28, 30, "Input", "ExpressionUUID" -> \
"c9d0a6bc-c80a-4a2f-900a-425a10323381"],
Cell[41345, 1273, 372, 8, 30, "Output", "ExpressionUUID" -> \
"d05f3af7-c646-41cb-9703-1b1ab9313b62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41754, 1286, 1841, 55, 69, "Input", "ExpressionUUID" -> \
"53bf8273-c44b-455b-93e2-84c076fbed21"],
Cell[43598, 1343, 149, 4, 30, "Output", "ExpressionUUID" -> \
"8a7c8372-17e4-4239-8aec-3404c368be06"]
}, Open  ]]
}
]
*)

