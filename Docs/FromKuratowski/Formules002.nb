(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    124081,       2768]
NotebookOptionsPosition[    121957,       2707]
NotebookOutlinePosition[    122300,       2722]
CellTagsIndexPosition[    122257,       2719]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"FileNameForTuple", "[", "primes_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fileName", ",", " ", "temp", ",", " ", "sep", ",", " ", "p", ",", " ", 
      "pPos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sep", " ", "=", " ", "\"\<\\\\\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", " ", "=", "\"\<d:\\\\triangle\\DataSrc\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"pPos", " ", "=", "1"}], ",", " ", 
       RowBox[{"pPos", " ", "<=", " ", 
        RowBox[{"Length", "[", "primes", "]"}]}], ",", " ", 
       RowBox[{"pPos", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", " ", "=", " ", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"temp", ",", " ", "sep", ",", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"primes", "[", 
             RowBox[{"[", "pPos", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", " ", "=", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"temp", ",", " ", "\"\<\\\\Solutions.txt\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fileName", " ", "=", " ", "temp"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "fileName", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4991686792777376`*^9, 3.4991687372450533`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Distance", "[", 
   RowBox[{"n_", ",", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "threshold", ",", " ", "digits", ",", " ", "position", ",", " ", "found",
       ",", " ", "nextPower", ",", " ", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"n", " ", "\[Equal]", "0"}], ",", " ", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Initialize", " ", "some", " ", "precomputed", " ", "local", " ", 
       "varables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"threshold", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "1"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"digits", " ", "=", " ", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"n", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "find", " ", "the", " ", "first", " ", "digit", " ", "above", " ", 
       "the", " ", "threshold"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"found", " ", "=", " ", 
      RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", " ", 
      RowBox[{
       RowBox[{"position", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"position", " ", "<=", 
        RowBox[{"Length", "[", "digits", "]"}]}], ",", " ", 
       RowBox[{"position", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"digits", " ", "[", 
           RowBox[{"[", "position", "]"}], "]"}], " ", ">", " ", 
          "threshold"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"found", " ", "=", " ", "position"}], ";", " ", 
          RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"if", " ", "we", " ", 
        RowBox[{"didn", "'"}], "t", " ", "find", " ", "a", " ", "digit"}], 
       ",", " ", 
       RowBox[{
       "then", " ", "the", " ", "distance", " ", "is", " ", "zero"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"found", " ", "==", 
        RowBox[{"-", "1"}]}], ",", " ", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"we", " ", "did", " ", "find", " ", "a", " ", "faulty", " ", 
        RowBox[{"digit", ".", "  ", "Now"}], " ", "we", " ", "need", " ", 
        "to", " ", "look", " ", "before", " ", "it", " ", "for", " ", 
        "digits", " ", "that", " ", "equal", " ", "the", " ", 
        RowBox[{"threshold", ".", "\[IndentingNewLine]", "If"}], " ", "we", 
        " ", "would", " ", "not", " ", "count", " ", "these", " ", "then", 
        " ", "we", " ", "would", " ", "end", " ", "up", " ", "with", " ", "a",
         " ", "new", " ", "value", " ", "which", " ", "is", " ", "still", " ",
         "not", " ", "p"}], "-", 
       RowBox[{"good", " ", 
        RowBox[{"(", 
         RowBox[{
         "due", "\[IndentingNewLine]", "to", " ", "the", " ", "carrying"}], 
         ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", " ", 
      RowBox[{
       RowBox[{"found", " ", ">", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"digits", " ", "[", 
           RowBox[{"[", 
            RowBox[{"found", "-", "1"}], "]"}], "]"}], " ", "==", " ", 
          "threshold"}], ",", 
         RowBox[{"found", " ", "--"}], ",", 
         RowBox[{"Break", "[", "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "if", " ", "we", " ", "have", " ", "gone", " ", "all", " ", "the", " ", 
       "way", " ", "to", " ", "the", " ", "start"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"found", " ", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nextPower", "=", " ", 
           RowBox[{"p", "^", 
            RowBox[{"(", 
             RowBox[{"Length", "[", "digits", "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"nextPower", "-", "n"}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nextPower", "=", " ", 
      RowBox[{"p", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "digits", "]"}], "+", "1", "-", "found"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"nextPower", "-", 
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"digits", ",", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", "digits", "]"}], "+", "1", "-", 
              "found"}], ")"}]}]}], "]"}], ",", "p"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.500213342917338*^9, 3.5002133693968525`*^9}, 
   3.5003943351060085`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FileNameForVotes", "[", "primes_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fileName", ",", " ", "temp", ",", " ", "sep", ",", " ", "p", ",", " ", 
      "pPos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sep", " ", "=", " ", "\"\<\\\\\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", " ", "=", "\"\<d:\\\\triangle\\Votes\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"pPos", " ", "=", "1"}], ",", " ", 
       RowBox[{"pPos", " ", "<=", " ", 
        RowBox[{"Length", "[", "primes", "]"}]}], ",", " ", 
       RowBox[{"pPos", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", " ", "=", " ", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"temp", ",", " ", "sep", ",", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"primes", "[", 
             RowBox[{"[", "pPos", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"DirectoryQ", "[", "temp", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Creating directory \>\"", " ", "<>", " ", "temp"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", "temp", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", " ", "=", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"temp", ",", " ", "\"\<\\\\Votes.txt\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fileName", " ", "=", " ", "temp"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "fileName", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.500211414243024*^9, 3.5002114160271263`*^9}, {
  3.5002114680821037`*^9, 3.5002114694961843`*^9}, {3.500211603218833*^9, 
  3.5002116045069065`*^9}, {3.5003705189011455`*^9, 3.5003705750703583`*^9}, {
  3.500370610300373*^9, 3.5003706172327695`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FileNameForVotedValues", "[", "primes_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fileName", ",", " ", "temp", ",", " ", "sep", ",", " ", "p", ",", " ", 
      "pPos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sep", " ", "=", " ", "\"\<\\\\\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", " ", "=", "\"\<d:\\\\triangle\\Votes\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"pPos", " ", "=", "1"}], ",", " ", 
       RowBox[{"pPos", " ", "<=", " ", 
        RowBox[{"Length", "[", "primes", "]"}]}], ",", " ", 
       RowBox[{"pPos", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", " ", "=", " ", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"temp", ",", " ", "sep", ",", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"primes", "[", 
             RowBox[{"[", "pPos", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"DirectoryQ", "[", "temp", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Creating directory \>\"", " ", "<>", " ", "temp"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", "temp", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", " ", "=", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"temp", ",", " ", "\"\<\\\\VotedValues.txt\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fileName", " ", "=", " ", "temp"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "fileName", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.501234185437208*^9, 3.5012341967738566`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FileNameForVotesPositions", "[", "primes_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fileName", ",", " ", "temp", ",", " ", "sep", ",", " ", "p", ",", " ", 
      "pPos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sep", " ", "=", " ", "\"\<\\\\\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", " ", "=", "\"\<d:\\\\triangle\\Votes\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"pPos", " ", "=", "1"}], ",", " ", 
       RowBox[{"pPos", " ", "<=", " ", 
        RowBox[{"Length", "[", "primes", "]"}]}], ",", " ", 
       RowBox[{"pPos", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", " ", "=", " ", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"temp", ",", " ", "sep", ",", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"primes", "[", 
             RowBox[{"[", "pPos", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"DirectoryQ", "[", "temp", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Creating directory \>\"", " ", "<>", " ", "temp"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", "temp", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", " ", "=", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"temp", ",", " ", "\"\<\\\\VoteOffsets.txt\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fileName", " ", "=", " ", "temp"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "fileName", "]"}]}]}], "\[IndentingNewLine]", "]"}
   ]}]], "Input",
 CellChangeTimes->{{3.50087976804764*^9, 3.5008797798253136`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GoodForTuple", "[", "primes_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fileName", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "[", "primes", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fileName", " ", "=", " ", 
      RowBox[{"FileNameForTuple", "[", "primes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"FileExistsQ", "[", "fileName", "]"}], "]"}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", " ", "[", " ", 
      RowBox[{"ReadList", "[", 
       RowBox[{"fileName", ",", "Number"}], "]"}], " ", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.499168829426326*^9, 3.499168955246522*^9}, {
   3.499169006278441*^9, 3.4991690065324554`*^9}, {3.499171764561206*^9, 
   3.4991717844133415`*^9}, {3.4991718169422016`*^9, 3.499171819589353*^9}, {
   3.499172352096811*^9, 3.4991723527698493`*^9}, {3.499174104348034*^9, 
   3.4991741053550916`*^9}, {3.49917909337139*^9, 3.4991791160786886`*^9}, 
   3.499179166822591*^9, {3.4991792636131268`*^9, 3.4991792640251503`*^9}, {
   3.499180045486848*^9, 3.499180055470419*^9}, {3.499180118944049*^9, 
   3.4991801240673423`*^9}, {3.499197949072874*^9, 3.4991979499449244`*^9}, {
   3.4993710812556686`*^9, 3.499371114234555*^9}, {3.4993711637553873`*^9, 
   3.499371183085493*^9}, {3.4993722044169097`*^9, 3.499372209735214*^9}, {
   3.4993768555099373`*^9, 3.499376877651203*^9}, 3.4993988314048862`*^9, {
   3.4994031706040745`*^9, 3.4994031725081835`*^9}, {3.4994045465027714`*^9, 
   3.499404548736899*^9}, {3.499411145883234*^9, 3.4994111482833714`*^9}, {
   3.4997825879725065`*^9, 3.499782603108372*^9}, {3.5002114064575787`*^9, 
   3.500211407859659*^9}, {3.500211565955702*^9, 3.500211567370783*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VotesForTuple", "[", "primes_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fileName", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "[", "primes", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fileName", " ", "=", " ", 
      RowBox[{"FileNameForVotes", "[", "primes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "fileName", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"FileExistsQ", "[", "fileName", "]"}], "]"}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", " ", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ReadList", "[", "fileName", "]"}], ",", "1"}], "]"}]}], 
       " ", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.500211394473893*^9, 3.5002113957969694`*^9}, {
  3.5002115298926387`*^9, 3.5002115898860703`*^9}, {3.500211625738121*^9, 
  3.5002116656424036`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VotedValuesForTuple", "[", 
   RowBox[{"primes_", ",", " ", "stopAt_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fileName", ",", " ", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fileName", " ", "=", " ", 
      RowBox[{"FileNameForVotedValues", "[", "primes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"FileExistsQ", "[", "fileName", "]"}], "]"}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"fileName", ",", "Expression", ",", "  ", "stopAt"}], "]"}]}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{"Return", " ", "[", "result", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.501234158385661*^9, 3.5012341726264753`*^9}, {
  3.5012344724736257`*^9, 3.501234475409794*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VoteVectorsForTuple", "[", 
   RowBox[{"primes_", ",", " ", "stopAt_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fileName", ",", " ", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fileName", " ", "=", " ", 
      RowBox[{"FileNameForVotes", "[", "primes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"FileExistsQ", "[", "fileName", "]"}], "]"}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", 
        RowBox[{
        "\"\<Reading :\>\"", " ", "<>", " ", "fileName", " ", "<>", " ", 
         "\"\< ... (\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "stopAt", "]"}], " ", "<>", " ", 
         "\"\< values )\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"fileName", ",", "Expression", ",", "  ", "stopAt"}], "]"}]}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Done.  Largest Value \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", " ", 
          RowBox[{"N", "[", 
           RowBox[{"Log", "[", 
            RowBox[{"10", ",", 
             RowBox[{
              RowBox[{"Last", "[", "result", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}], " ", "<>",
          " ", "\"\<  -  \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "result", "]"}], "]"}], " ", "<>", " ", 
         "\"\< values read.\>\""}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", " ", "[", "result", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5003660598911047`*^9, 3.5003661106940107`*^9}, {
   3.5003670527458925`*^9, 3.5003670783573575`*^9}, {3.5003671111962357`*^9, 
   3.5003671447061524`*^9}, {3.5003671811872387`*^9, 3.500367202796475*^9}, {
   3.5003673271255865`*^9, 3.5003673352240496`*^9}, 3.500368201085574*^9, {
   3.5003682793540506`*^9, 3.5003682825452332`*^9}, {3.500368458445294*^9, 
   3.500368466682765*^9}, {3.5003685096592236`*^9, 3.5003685127033978`*^9}, {
   3.500368559473072*^9, 3.5003685990513363`*^9}, {3.5003689519215193`*^9, 
   3.5003689579378633`*^9}, {3.500404589737674*^9, 3.500404663638901*^9}, {
   3.5005331967136292`*^9, 3.5005332466564856`*^9}, {3.500533278477306*^9, 
   3.500533287481821*^9}, {3.500626360633301*^9, 3.5006263863547716`*^9}, {
   3.501191132525938*^9, 3.5011911633671923`*^9}, {3.5011913600211377`*^9, 
   3.501191366167548*^9}, {3.50119759015016*^9, 3.5011976130978003`*^9}, {
   3.501234048166357*^9, 3.5012340545967245`*^9}, {3.50123849637978*^9, 
   3.501238508326463*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphForNumber2", "[", 
   RowBox[{"n_", ",", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "result", ",", " ", "pos", ",", " ", "digs", ",", "f", ",", "t", ",", 
      " ", "lbl"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"digs", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"n", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pos", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t", "=", " ", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"FromDigits", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"digs", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "pos"}], "}"}]}], "]"}], ",", "p"}], "]"}], 
        "]"}], " ", "<>", " ", "\"\<-\>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"Length", "[", "digs", "]"}], "-", "pos"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "digs", "]"}], "\[Equal]", "1"}], ",", " ", 
       RowBox[{"t", "=", "n"}]}], "]"}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{"lbl", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"digs", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Start\>\"", " ", "->", " ", "t"}], "  ", ",", "lbl"}], 
        "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"pos", "=", "1"}], ",", " ", 
       RowBox[{"pos", " ", "<", " ", 
        RowBox[{"Length", "[", "digs", "]"}]}], " ", ",", " ", 
       RowBox[{"pos", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "=", " ", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"FromDigits", "[", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"digs", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "pos"}], "}"}]}], "]"}], ",", "p"}], "]"}], 
           "]"}], " ", "<>", " ", "\"\<-\>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"Length", "[", "digs", "]"}], "-", "pos"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"t", "=", " ", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"FromDigits", "[", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"digs", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"pos", "+", "1"}]}], "}"}]}], "]"}], ",", "p"}], 
            "]"}], "]"}], " ", "<>", " ", "\"\<-\>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"Length", "[", "digs", "]"}], "-", "pos", "-", "1"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{"pos", " ", "==", " ", 
           RowBox[{
            RowBox[{"Length", "[", "digs", "]"}], "-", "1"}]}], ",", " ", 
          RowBox[{"t", "=", "n"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"lbl", "=", 
         RowBox[{"ToString", "[", 
          RowBox[{"digs", "[", 
           RowBox[{"[", 
            RowBox[{"pos", "+", "1"}], "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"result", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"f", "\[Rule]", "t"}], " ", ",", "lbl"}], "}"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQnZGz6M4r4VeOf/JjnoHoC3ebP4LoCQtv/gbRRkvY
OF4D6ZnrFERAtEZ9oASITnI6pAGi5/vFeoDobeZTwbTT7IAcEN3e3AWmX0kc
qgTRT1o/gOkoHrPjIJrlzPwTIDptyrKrIFqBo/EFiH62z+w3iL75W5zxDZCu
L1MXAdF5YeFger7HLQkQ7T9rrgyIPvRjxxIQ3RzMsgNEP5qpW6ss8srxSvij
HhAty8k+HUQ/kZcA04wiGcIGQPqvz0wZEL3rzNV5IPqJ0gMwrbAk4oIhkP60
6ukVEB3tkn4bRP9buwNMAwBEGZea
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"InternalCalculateVotes", "[", 
   RowBox[{"primes_", ",", " ", "count_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "current", ",", "  ", "maxdist", ",", " ", "distanceTable", ",", " ", 
      "pos", ",", " ", "fileName", ",", " ", "previous", ",", " ", "result"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fileName", " ", "=", " ", 
      RowBox[{"FileNameForVotes", "[", "primes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"previous", " ", "=", " ", 
      RowBox[{"VoteVectorsForTuple", "[", 
       RowBox[{"primes", ",", "count"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "previous", "]"}], "\[GreaterEqual]", " ", 
        "count"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"previous", ",", "count"}], "]"}]}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "start", " ", "of", " ", "giant", " ", "else", " ", "clause"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "previous", "]"}], "==", "0"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pos", " ", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"current", " ", "=", " ", "0"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pos", " ", "=", " ", 
            RowBox[{"Length", "[", "previous", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"current", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"previous", "[", 
               RowBox[{"[", "pos", "]"}], "]"}], " ", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"previous", "[", 
                RowBox[{"[", "pos", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"pos", "<=", " ", "count"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "current", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"distanceTable", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Distance", "[", 
               RowBox[{"current", ",", " ", "p"}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"p", ",", " ", "primes"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"With", " ", "[", "\[IndentingNewLine]", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"file", " ", "=", " ", 
               RowBox[{"OpenAppend", "[", 
                RowBox[{"fileName", ",", " ", 
                 RowBox[{"PageWidth", "\[Rule]", "40000"}]}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Write", "[", 
               RowBox[{"file", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"current", ",", "distanceTable"}], "}"}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Close", "[", "file", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"pos", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"pos", ",", "10000"}], "]"}], "\[Equal]", "0"}], ",",
                " ", 
               RowBox[{"PrintTemporary", "[", 
                RowBox[{"\"\< Calculating votes :\>\"", " ", "<>", " ", 
                 RowBox[{"ToString", "[", "pos", "]"}], " ", "<>", " ", 
                 "\"\< / \>\"", " ", "<>", " ", 
                 RowBox[{"ToString", "[", "count", "]"}], " ", "<>", " ", 
                 "\"\< - \>\"", " ", "<>", " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"N", "[", 
                   RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "current"}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"maxdist", " ", "=", " ", 
            RowBox[{"Max", "[", "distanceTable", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"maxdist", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"current", " ", "+=", "1"}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"current", " ", "+=", " ", "maxdist"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"VoteVectorsForTuple", "[", 
          RowBox[{"primes", ",", "count"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"end", " ", "of", " ", "giant", " ", "else", " ", "clause"}], 
       " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5002493560641723`*^9, 3.5002494093442197`*^9}, {
   3.500249444695242*^9, 3.5002494628282785`*^9}, {3.5002496196362476`*^9, 
   3.5002496200722723`*^9}, {3.500304491016652*^9, 3.500304498587085*^9}, {
   3.500315183257213*^9, 3.5003152341641245`*^9}, {3.5003154392038527`*^9, 
   3.500315529305006*^9}, {3.5003659566071973`*^9, 3.500366029287354*^9}, {
   3.5003661233027315`*^9, 3.5003663514337797`*^9}, {3.500366385228713*^9, 
   3.5003663876398506`*^9}, 3.5003664323194065`*^9, {3.500366476942959*^9, 
   3.500366502984448*^9}, {3.500366561430791*^9, 3.500366805920775*^9}, {
   3.5003668503043137`*^9, 3.5003668566696777`*^9}, {3.5003669050974474`*^9, 
   3.5003669132449136`*^9}, {3.5003670014479585`*^9, 3.500367023834239*^9}, {
   3.5003672421987286`*^9, 3.5003672458859396`*^9}, {3.5003672842931366`*^9, 
   3.5003672891334133`*^9}, {3.500367350649932*^9, 3.5003673540651274`*^9}, {
   3.5003673885621004`*^9, 3.5003674016458483`*^9}, {3.500367449971613*^9, 
   3.5003674680476465`*^9}, 3.500367572113599*^9, {3.500368210950138*^9, 
   3.500368211929194*^9}, {3.5003682508684216`*^9, 3.500368254314618*^9}, {
   3.500368424218336*^9, 3.500368429738652*^9}, {3.5003684754252653`*^9, 
   3.5003684797185106`*^9}, {3.500368647952133*^9, 3.5003686816930633`*^9}, {
   3.500368896699361*^9, 3.500368903923774*^9}, {3.5003691702800083`*^9, 
   3.500369199904703*^9}, {3.500395605255241*^9, 3.500395605567241*^9}, {
   3.500448649806766*^9, 3.5004486709459753`*^9}, {3.500457020752557*^9, 
   3.500457068836307*^9}, {3.500493976932329*^9, 3.5004940005166783`*^9}, {
   3.5004941170363426`*^9, 3.5004941403026733`*^9}, {3.500732505069415*^9, 
   3.50073250778557*^9}, 3.500752896248724*^9, 3.5011945467595987`*^9, {
   3.5011954769548483`*^9, 3.5011955612573967`*^9}, 3.501196343848371*^9, {
   3.501231697465904*^9, 3.501231702580197*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DynamicVotedValues", "[", 
   RowBox[{"primes_", ",", " ", "count_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "current", ",", "  ", "maxdist", ",", " ", "distanceTable", ",", " ", 
      "pos", ",", " ", "fileName", ",", " ", "previous", ",", " ", "result"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fileName", " ", "=", " ", 
        RowBox[{"FileNameForVotedValues", "[", "primes", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"previous", " ", "=", " ", 
        RowBox[{"VotedValuesForTuple", "[", 
         RowBox[{"primes", ",", "count"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "previous", "]"}], "\[GreaterEqual]", " ", 
          "count"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"previous", ",", "count"}], "]"}]}], "\[IndentingNewLine]",
          ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "start", " ", "of", " ", "giant", " ", "else", " ", "clause"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "previous", "]"}], "==", "0"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pos", " ", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"current", " ", "=", " ", "0"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pos", " ", "=", " ", 
              RowBox[{"Length", "[", "previous", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"current", " ", "=", " ", 
              RowBox[{"previous", "[", 
               RowBox[{"[", "pos", "]"}], "]"}]}], " ", ";", 
             "\[IndentingNewLine]", 
             RowBox[{"current", " ", "+=", " ", 
              RowBox[{"Max", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Distance", "[", 
                  RowBox[{"current", ",", " ", "p"}], "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", " ", "primes"}], "}"}]}], "]"}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"pos", "<=", " ", "count"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "current", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"distanceTable", " ", "=", " ", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Distance", "[", 
                 RowBox[{"current", ",", " ", "p"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"p", ",", " ", "primes"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"With", " ", "[", "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"file", " ", "=", " ", 
                 RowBox[{"OpenAppend", "[", 
                  RowBox[{"fileName", ",", " ", 
                   RowBox[{"PageWidth", "\[Rule]", "40000"}]}], "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Write", "[", 
                 RowBox[{"file", ",", " ", "current"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Close", "[", "file", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"pos", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"pos", ",", "10000"}], "]"}], "\[Equal]", "0"}], 
                 ",", " ", 
                 RowBox[{"PrintTemporary", "[", 
                  RowBox[{"\"\< Calculating votes :\>\"", " ", "<>", " ", 
                   RowBox[{"ToString", "[", "pos", "]"}], " ", "<>", " ", 
                   "\"\< / \>\"", " ", "<>", " ", 
                   RowBox[{"ToString", "[", "count", "]"}], " ", "<>", " ", 
                   "\"\< - \>\"", " ", "<>", " ", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "current"}], "]"}], "]"}], "]"}]}], 
                  "]"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"maxdist", " ", "=", " ", 
              RowBox[{"Max", "[", "distanceTable", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"maxdist", "\[Equal]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"current", " ", "+=", "1"}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"current", " ", "+=", " ", "maxdist"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"VotedValuesForTuple", "[", 
            RowBox[{"primes", ",", "count"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"end", " ", "of", " ", "giant", " ", "else", " ", "clause"}],
          " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "result", "]"}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", "pos", "]"}], " ", "<>", " ", "\"\< - \>\"", 
       " ", "<>", " ", 
       RowBox[{"ToString", "[", 
        RowBox[{"N", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "current"}], "]"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5012341274368906`*^9, 3.5012341416297026`*^9}, {
   3.5012342114386954`*^9, 3.5012342461096783`*^9}, {3.501234280088622*^9, 
   3.5012343142215743`*^9}, {3.501234412143175*^9, 3.5012344312992706`*^9}, {
   3.5012345151790686`*^9, 3.5012345351152086`*^9}, {3.501234565799964*^9, 
   3.5012345753905125`*^9}, 3.5012347175596437`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DynamicVoteList", "[", 
   RowBox[{"primes_", ",", " ", "count_"}], "]"}], " ", ":=", " ", 
  RowBox[{"InternalCalculateVotes", "[", 
   RowBox[{"primes", ",", "count"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5002493560641723`*^9, 3.5002494093442197`*^9}, {
  3.500249444695242*^9, 3.5002494628282785`*^9}, {3.5002496196362476`*^9, 
  3.5002496200722723`*^9}, {3.500304491016652*^9, 3.500304498587085*^9}, {
  3.500315183257213*^9, 3.5003152341641245`*^9}, {3.5003154392038527`*^9, 
  3.500315529305006*^9}, {3.5003659566071973`*^9, 3.500366029287354*^9}, {
  3.5003661233027315`*^9, 3.5003661916486406`*^9}, {3.5003687367872143`*^9, 
  3.5003687684570255`*^9}, {3.500368828021433*^9, 3.5003688575581217`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DynamicVoteList", "[", 
   RowBox[{"primes_", ",", "start_", ",", " ", "count_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "current", ",", "  ", "maxdist", ",", " ", "currentVector", ",", " ", 
      "pos", ",", " ", "posChunk", ",", " ", "fileName", ",", " ", "previous",
       ",", " ", "chunks", ",", " ", "lastValue", ",", " ", "result", ",", 
      " ", "prevLen", ",", "distanceTable", ",", " ", "temp", ",", " ", 
      "offsetFileName", ",", " ", "offsets"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fileName", " ", "=", " ", 
      RowBox[{"FileNameForVotes", "[", "primes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"offsetFileName", "=", 
      RowBox[{"FileNameForVotesPositions", "[", "primes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"chunks", "=", 
      RowBox[{
       RowBox[{"IntegerPart", "[", 
        RowBox[{"start", " ", "/", " ", "count"}], "]"}], "+", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Reading :\>\"", " ", "<>", " ", "fileName", " ", "<>", " ", 
       "\"\< ... (\>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", "chunks", "]"}], " ", "<>", " ", 
       "\"\< chunks )\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "fileName", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"With", " ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"file", " ", "=", " ", 
            RowBox[{"OpenRead", "[", "fileName", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"offsets", " ", "=", " ", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{"FileExistsQ", "[", "offsetFileName", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"f", " ", "=", " ", 
                  RowBox[{"OpenRead", "[", "offsetFileName", "]"}]}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"offsets", " ", "=", " ", 
                  RowBox[{"ReadList", "[", 
                   RowBox[{"f", ",", " ", "Expression"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Close", "[", "f", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", " ", "[", 
            RowBox[{
             RowBox[{"posChunk", "=", "1"}], ",", " ", 
             RowBox[{"posChunk", " ", "\[LessEqual]", " ", "chunks"}], ",", 
             " ", 
             RowBox[{"posChunk", " ", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"posChunk", " ", "<", " ", "chunks"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<  - Chunk :\>\"", " ", "<>", " ", 
                   RowBox[{"ToString", "[", "posChunk", "]"}], " ", "<>", 
                   " ", "\"\< ...  Searching offset for  : \>\"", " ", "<>", 
                   " ", 
                   RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"posChunk", "-", "1"}], ")"}], "*", "count"}], 
                    "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"offset", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"offsets", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"posChunk", "-", "1"}], ")"}], "*", "count"}]}], 
                    "&"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "offset", "]"}], " ", ">", "0"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"offset", "=", " ", 
                    RowBox[{"offset", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<  - Chunk :\>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", "posChunk", "]"}], " ", "<>", 
                    " ", "\"\< ...  Offset known, skipping : \>\"", " ", "<>",
                     " ", 
                    RowBox[{"ToString", "[", "offset", "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetStreamPosition", "[", 
                    RowBox[{"file", ",", " ", "offset"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Continue", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"temp", " ", "=", " ", 
               RowBox[{"ReadList", "[", 
                RowBox[{"file", ",", " ", "Expression", ",", " ", "count"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "temp", "]"}], "==", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"previous", "=", 
                  RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"previous", " ", "=", " ", "temp"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", " ", "[", 
               RowBox[{
                RowBox[{"previous", " ", "\[Equal]", " ", "$Failed"}], ",", 
                " ", 
                RowBox[{
                 RowBox[{"previous", " ", "=", " ", 
                  RowBox[{"{", "}"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"pos", " ", "+=", " ", 
               RowBox[{"Length", "[", "previous", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"currentVector", "=", " ", 
               RowBox[{"Last", "[", "previous", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"lastValue", "=", 
               RowBox[{"N", "[", 
                RowBox[{"Log", "[", 
                 RowBox[{"10", ",", 
                  RowBox[{"1", "+", 
                   RowBox[{"currentVector", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "]"}], " ", 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"current", " ", "=", " ", 
               RowBox[{
                RowBox[{"currentVector", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{"currentVector", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<  - Chunk :\>\"", " ", "<>", " ", 
                RowBox[{"ToString", "[", "posChunk", "]"}], " ", "<>", " ", 
                "\"\< ... (\>\"", " ", "<>", " ", 
                RowBox[{"ToString", "[", "lastValue", "]"}], " ", "<>", " ", 
                "\"\<)\>\""}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", " ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "previous", "]"}], " ", "\[NotEqual]",
                  " ", "count"}], ",", " ", 
                RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"posFile", " ", "=", " ", 
                  RowBox[{"OpenAppend", "[", 
                   RowBox[{"offsetFileName", ",", " ", 
                    RowBox[{"PageWidth", "\[Rule]", "2000"}]}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Write", "[", 
                  RowBox[{"posFile", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"posChunk", "*", "count"}], ",", " ", 
                    RowBox[{"StreamPosition", "[", "file", "]"}]}], "}"}]}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Close", "[", "posFile", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Close", "[", "file", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"file", " ", "does", " ", "not", " ", "exist"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"previous", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"current", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"lastValue", "=", "\"\<Not found\>\""}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Done.  Largest Value \>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", " ", "lastValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Start pos \>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", " ", "pos", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Start value \>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", " ", "current", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", "previous"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prevLen", " ", "=", 
      RowBox[{"Length", "[", "previous", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<length previous \>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", " ", "prevLen", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<count \>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", " ", "count", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<count \>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", " ", 
        RowBox[{"prevLen", " ", "<", " ", "count"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"prevLen", " ", "<", " ", "count"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Not enough values, calculating more...\>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"start", " ", "+", " ", "count", " ", "-", " ", "pos"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", " ", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"pos", "<", " ", 
           RowBox[{"start", " ", "+", " ", "count"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "current", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"distanceTable", " ", "=", " ", 
            RowBox[{"ParallelTable", "[", 
             RowBox[{
              RowBox[{"Distance", "[", 
               RowBox[{"current", ",", " ", "p"}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"p", ",", " ", "primes"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"With", " ", "[", "\[IndentingNewLine]", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"file", " ", "=", " ", 
               RowBox[{"OpenAppend", "[", 
                RowBox[{"fileName", ",", " ", 
                 RowBox[{"PageWidth", "\[Rule]", "40000"}]}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Write", "[", 
               RowBox[{"file", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"current", ",", "distanceTable"}], "}"}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"If", " ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"pos", "+", "1"}], ",", "10000"}], "]"}], 
                 "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"posFile", " ", "=", " ", 
                    RowBox[{"OpenAppend", "[", 
                    RowBox[{"offsetFileName", ",", " ", 
                    RowBox[{"PageWidth", "\[Rule]", "2000"}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Write", "[", 
                    RowBox[{"posFile", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pos", "+", "1"}], ",", " ", 
                    RowBox[{"StreamPosition", "[", "file", "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Close", "[", "posFile", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Close", "[", "file", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"pos", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"pos", ",", "10000"}], "]"}], "\[Equal]", "0"}], ",", 
             " ", 
             RowBox[{"PrintTemporary", "[", 
              RowBox[{"\"\< Calculating votes :\>\"", " ", "<>", " ", 
               RowBox[{"ToString", "[", "pos", "]"}], " ", "<>", " ", 
               "\"\< / \>\"", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"start", " ", "+", " ", "count"}], "]"}], " ", "<>", 
               " ", "\"\< - \>\"", " ", "<>", " ", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", 
                 RowBox[{"Log", "[", 
                  RowBox[{"10", ",", "current"}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"maxdist", " ", "=", " ", 
            RowBox[{"Max", "[", "distanceTable", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"maxdist", "\[Equal]", "0"}], ",", 
             RowBox[{"current", " ", "+=", "1"}], " ", ",", 
             RowBox[{"current", " ", "+=", " ", "maxdist"}]}], "]"}], ";"}]}],
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"DynamicVoteList", "[", 
          RowBox[{"primes", ",", " ", "start", ",", " ", "count"}], "]"}]}], 
        ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<enough values\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.500368783163867*^9, 3.500368816590779*^9}, 
   3.500394389222503*^9, {3.500813892362502*^9, 3.5008138948866463`*^9}, 
   3.500813960909423*^9, 3.500872608124116*^9, {3.5008726777951007`*^9, 
   3.5008727838751683`*^9}, {3.5008728363441696`*^9, 
   3.5008729171377907`*^9}, {3.500872966094591*^9, 3.5008730413068924`*^9}, {
   3.500873079604083*^9, 3.5008731503551297`*^9}, {3.5008737617841015`*^9, 
   3.5008738223145638`*^9}, {3.50087386001872*^9, 3.5008740837205153`*^9}, {
   3.500874121291664*^9, 3.500874221026369*^9}, 3.50087425584836*^9, {
   3.500874679539594*^9, 3.500874697091598*^9}, {3.500874734098715*^9, 
   3.5008747347597523`*^9}, {3.5008747888728476`*^9, 
   3.5008747906269484`*^9}, {3.500874830769244*^9, 3.500874831098263*^9}, {
   3.5008748613759947`*^9, 3.500874861716014*^9}, {3.5008754559049997`*^9, 
   3.500875705613282*^9}, {3.500875919831535*^9, 3.5008759708614535`*^9}, {
   3.50087605122805*^9, 3.50087607114919*^9}, {3.5008761265613594`*^9, 
   3.5008761526118493`*^9}, {3.5008761935351896`*^9, 3.500876199255517*^9}, {
   3.500876306680661*^9, 3.500876349399105*^9}, 3.5008763846501207`*^9, {
   3.500876501521806*^9, 3.500876510461317*^9}, {3.5008765476944466`*^9, 
   3.500876562804311*^9}, {3.5008766316462483`*^9, 3.5008767777386045`*^9}, {
   3.5008768133376403`*^9, 3.500876835956934*^9}, {3.500877066220104*^9, 
   3.5008771844818687`*^9}, {3.500877250021617*^9, 3.5008772592061424`*^9}, 
   3.5008795537603836`*^9, {3.500879796557271*^9, 3.5008799962246914`*^9}, {
   3.500880063750553*^9, 3.5008800647556105`*^9}, {3.5008804797393465`*^9, 
   3.5008804801233683`*^9}, {3.500880786608898*^9, 3.5008808112893105`*^9}, {
   3.500880858684021*^9, 3.5008812505674353`*^9}, {3.5008813006983027`*^9, 
   3.5008813180372944`*^9}, {3.5008813856941643`*^9, 3.5008814201221333`*^9}, 
   3.501009123951053*^9, {3.5010100521621437`*^9, 3.501010094948591*^9}, {
   3.501010830916686*^9, 3.5010108346619005`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawTupleVotes", "[", 
    RowBox[{"tuple_", ",", " ", "range_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"g", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
             RowBox[{"DynamicVoteList", "[", 
              RowBox[{"tuple", ",", " ", 
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", "]"}]}], " ", 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "g", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"threshold", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p", "+", "1"}], ")"}], "/", "2"}]}], ",", 
                "\[IndentingNewLine]", " ", 
                RowBox[{"start", " ", "=", " ", 
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"range", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"end", "=", " ", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"Length", "[", "g", "]"}], ",", 
                   RowBox[{"range", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"TreePlot", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"GraphForNumber2", "[", 
                    RowBox[{"i", ",", "p"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", 
                    RowBox[{"Take", "[", 
                    RowBox[{"g", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"start", ",", " ", "end"}], "}"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
                "\[IndentingNewLine]", "Left", ",", "\[IndentingNewLine]", 
                RowBox[{"MultiedgeStyle", "\[Rule]", "None"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"DirectedEdges", "\[Rule]", "False"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"VertexLabeling", "\[Rule]", "True"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"EdgeRenderingFunction", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"pos", ",", "edge", ",", "lbl"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", " ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"FromDigits", "[", "lbl", "]"}], " ", "<", " ", 
                    "threshold"}], ",", "Blue", ",", " ", "Red"}], "]"}], ",",
                     " ", 
                    RowBox[{"Line", "[", "pos", "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Inset", "[", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"Mean", "[", "pos", "]"}], ",", "Automatic", ",", 
                    "Automatic", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",",
                     " ", 
                    RowBox[{"FontSize", "\[Rule]", "Larger"}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"VertexRenderingFunction", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"pos", ",", "vertex"}], "}"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "vertex", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Distance", "[", 
                    RowBox[{"vertex", ",", "pl"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"pl", ",", " ", "tuple"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", " ", "Green", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Distance", "[", 
                    RowBox[{"vertex", ",", "p"}], "]"}], "\[Equal]", "0"}], 
                    ",", " ", "Orange", ",", " ", "Red"}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ",", 
                    RowBox[{"EdgeForm", "[", "Black", "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"vertex", ",", "pos"}], "]"}], ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",",
                     " ", 
                    RowBox[{"FontSize", "\[Rule]", "Tiny"}], ",", " ", 
                    RowBox[{"FontColor", "\[Rule]", "White"}]}], "]"}]}], 
                    "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PointSize", "[", "0.001", "]"}], ",", 
                    RowBox[{"Point", "[", "pos", "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotLabel", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"ToString", "[", "tuple", "]"}], " ", "<>", " ", 
                  "\"\<-voted values\\nin base \>\"", " ", "<>", " ", 
                  RowBox[{"ToString", " ", "[", "p", "]"}], "  ", "<>", 
                  "\"\<\\nfor vote \>\"", "  ", "<>", " ", 
                  RowBox[{"ToString", "[", "start", " ", "]"}], "<>", " ", 
                  "\"\< to \>\"", " ", "<>", " ", 
                  RowBox[{"ToString", "[", " ", "end", "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",", 
                   " ", 
                   RowBox[{"FontSize", "\[Rule]", "Larger"}]}], "}"}]}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"p", ",", "tuple"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5002113426849313`*^9, 3.500211379746051*^9}, {
   3.500211702906535*^9, 3.5002118473007936`*^9}, {3.5002119393160563`*^9, 
   3.500211946397462*^9}, {3.5002120166884823`*^9, 3.500212067497388*^9}, {
   3.500212113032993*^9, 3.500212133950189*^9}, {3.500212181648917*^9, 
   3.500212315124552*^9}, {3.5002123660614653`*^9, 3.500212386889656*^9}, {
   3.5002124303881445`*^9, 3.5002125276767087`*^9}, {3.500212588410183*^9, 
   3.5002126718939576`*^9}, {3.5002127068049545`*^9, 
   3.5002127119402485`*^9}, {3.5002127586829214`*^9, 
   3.5002127665613728`*^9}, {3.5002128027204404`*^9, 
   3.5002128097878447`*^9}, {3.500212985542897*^9, 3.500213076901123*^9}, {
   3.500219504201743*^9, 3.500219505160798*^9}, {3.5002454511448236`*^9, 
   3.5002455820793123`*^9}, {3.500245648513112*^9, 3.5002457137498436`*^9}, {
   3.500245791272278*^9, 3.50024580337897*^9}, {3.500245893123103*^9, 
   3.500245952171481*^9}, {3.500246018297263*^9, 3.500246025223659*^9}, {
   3.500246083036966*^9, 3.500246103936161*^9}, {3.500246138902161*^9, 
   3.5002461543330436`*^9}, {3.500246210606262*^9, 3.5002462155055428`*^9}, {
   3.500247741842844*^9, 3.5002478112768154`*^9}, {3.500248385704671*^9, 
   3.500248390149925*^9}, {3.5002485279498067`*^9, 3.500248550770112*^9}, {
   3.5002486072013397`*^9, 3.5002486214061522`*^9}, {3.500248840700695*^9, 
   3.5002488551005187`*^9}, {3.500249483539463*^9, 3.500249505137699*^9}, {
   3.5002495802419944`*^9, 3.500249613919921*^9}, {3.5002496584084654`*^9, 
   3.500249666460926*^9}, {3.5002497307626038`*^9, 3.500249736593937*^9}, 
   3.50024981391636*^9, {3.5002498756488905`*^9, 3.5002498829373074`*^9}, 
   3.50024991672324*^9, {3.500250040520321*^9, 3.5002500519419737`*^9}, 
   3.5002504401331778`*^9, {3.500250539920885*^9, 3.500250599292281*^9}, {
   3.5002507070244427`*^9, 3.5002507153599195`*^9}, {3.500250823678115*^9, 
   3.500250832069595*^9}, 3.5002508963622723`*^9, {3.500250979038001*^9, 
   3.5002509828212175`*^9}, 3.500251076451573*^9, {3.5002511165728674`*^9, 
   3.500251133556839*^9}, {3.5002512207878284`*^9, 3.500251242995098*^9}, {
   3.5002512848834944`*^9, 3.500251285774545*^9}, {3.5002513378575244`*^9, 
   3.5002513380625362`*^9}, {3.5002525048652735`*^9, 3.5002525060553417`*^9}, 
   3.5002528191122475`*^9, {3.500407678214325*^9, 3.5004076787523556`*^9}, {
   3.5006209013880496`*^9, 3.5006209044612255`*^9}}],

Cell[CellGroupData[{

Cell["This notebook requires some definitions from DigitGraphs.nb", "Item",
 CellChangeTimes->{{3.5003656974733753`*^9, 3.500365716710476*^9}}],

Cell["\<\
MyPosition will calculate the first position of a \"bad digit\" starting from \
the left (most significant digit).
   It will return this position if something is found or zero if none is \
found.  The M built - in Position function was not really cooperative.\
\>", "Item",
 CellChangeTimes->{{3.500365286269856*^9, 3.500365390596823*^9}, {
  3.50036573620059*^9, 3.500365737321655*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyPosition", "[", 
   RowBox[{"l_", ",", " ", "threshold_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", " ", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"Length", "[", "l", "]"}]}], ",", " ", 
       RowBox[{"pos", "\[GreaterEqual]", "1"}], " ", ",", " ", 
       RowBox[{"pos", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"l", "[", 
           RowBox[{"[", "pos", "]"}], "]"}], " ", "\[GreaterEqual]", " ", 
          "threshold"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", " ", "=", " ", "pos"}], ";", " ", 
          RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", " ", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.500279685747446*^9, 3.500279948997908*^9}, {
  3.500279981305565*^9, 3.500280025890443*^9}}],

Cell["\<\
Calculating bad positions takes time.  We need it both for graphing votes and \
voted values.  Therefore we write a simple function that does the calculation \
and gives feedback for large calculations.
It also allows us to change both graph types at once.\
\>", "Text",
 CellChangeTimes->{{3.5003651311959867`*^9, 3.500365220915118*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FirstBadPosition", "[", 
   RowBox[{"votes_", ",", " ", "tuple_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"vIndex", ",", "10000"}], "]"}], "\[Equal]", "0"}], ",", " ", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<First bad \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "vIndex", "]"}], " ", "<>", " ", 
         "\"\< / \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
         "\"\< for prime \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "p", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"With", " ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"digs", "=", 
         RowBox[{"IntegerDigits", "[", 
          RowBox[{
           RowBox[{"votes", "[", 
            RowBox[{"[", "vIndex", "]"}], "]"}], ",", "p"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"MyPosition", "[", 
          RowBox[{"digs", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "+", "1"}], ")"}], "/", "2"}]}], "]"}], "  ", "/", 
         " ", 
         RowBox[{"Length", "[", "digs", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"p", ",", "tuple"}], "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"vIndex", ",", "1", ",", 
      RowBox[{"Length", "[", "votes", "]"}]}], "}"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.500362109145235*^9, 3.500362289247552*^9}, {
  3.5003625343551826`*^9, 3.500362554104817*^9}, {3.5003626598886027`*^9, 
  3.5003626948170643`*^9}, {3.5003627804456143`*^9, 3.500362784844822*^9}, {
  3.5003628650445633`*^9, 3.5003628711129737`*^9}, {3.500363594787109*^9, 
  3.500363614408231*^9}, {3.5003654262658634`*^9, 3.5003654522333484`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FirstBadPositionGraphFor", "[", 
   RowBox[{"tuple_", ",", " ", "count_"}], "]"}], ":=", 
  RowBox[{"FirstBadPositionGraphFor", "[", 
   RowBox[{"tuple", ",", " ", "count", ",", " ", "tuple"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5006234618655005`*^9, 3.5006234686078863`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FirstBadPositionGraphFor", "[", 
   RowBox[{"tuple_", ",", " ", "count_", ",", " ", "plotTuple_"}], "]"}], " ",
   ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "votes", " ", "are", " ", "a", " ", "couple", " ", "in", " ", "which", 
       " ", "the", " ", "first", " ", "value", " ", "is", " ", "the", " ", 
       "voted", " ", "value", " ", "and", " ", "the", " ", "second", " ", 
       "is", " ", "a", " ", "tuple", " ", "containing", " ", "the", " ", 
       "votes", " ", "for", " ", "each", " ", 
       RowBox[{"prime", ".", "\[IndentingNewLine]", "Here"}], " ", "we", " ", 
       "are", " ", "interested", " ", "in", " ", "the", " ", "voted", " ", 
       "value", " ", "so", " ", "we", " ", "just", " ", "take", " ", "the", 
       " ", "first", " ", "element", " ", "using", " ", "a", " ", "Map", " ", 
       "call"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"votes", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
           RowBox[{"DynamicVoteList", "[", 
            RowBox[{"tuple", ",", " ", "count"}], "]"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FirstBadPosition", "[", 
          RowBox[{"votes", ",", " ", "plotTuple"}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Opacity", "[", "0.6", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "\"\<First bad digit in voted value divided by length for \>\"", 
           " ", "<>", " ", 
           RowBox[{"ToString", "[", "tuple", "]"}], " ", "<>", " ", 
           "\"\<\\n(\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
           "\"\< values)\\nLargest voted value (log10):\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"N", "[", 
             RowBox[{"Log", "[", 
              RowBox[{"10", ",", 
               RowBox[{"votes", "[", 
                RowBox[{"[", "count", "]"}], "]"}]}], "  ", "]"}], "]"}], 
            "]"}], "<>", " ", "\"\<\\nPlotted for :\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", "plotTuple", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<N th vote\>\"", ",", "  ", 
            "\"\<Ratio position first bad / length representation\>\""}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",", " ", 
            RowBox[{"FontSize", "\[Rule]", "Larger"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5002805370159416`*^9, 3.500280620522888*^9}, {
   3.500292422304497*^9, 3.5002925230122566`*^9}, {3.5002928559122972`*^9, 
   3.500292858734459*^9}, {3.5003169348083963`*^9, 3.50031693610147*^9}, {
   3.5003191463068867`*^9, 3.500319151761198*^9}, {3.50036546519709*^9, 
   3.500365560114519*^9}, {3.5003690450868483`*^9, 3.5003690454838705`*^9}, {
   3.500617183842418*^9, 3.500617197394193*^9}, 3.5006172670711784`*^9, {
   3.500623480580571*^9, 3.5006235165526285`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FirstBadPositionGraphForPrimeVote", "[", 
   RowBox[{"tuple_", ",", " ", "count_", ",", " ", "primeVoteIndex_"}], "]"}],
   " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "votes", " ", "are", " ", "a", " ", "couple", " ", "in", " ", "which", 
       " ", "the", " ", "first", " ", "value", " ", "is", " ", "the", " ", 
       "voted", " ", "value", " ", "and", " ", "the", " ", "second", " ", 
       "is", " ", "a", " ", "tuple", " ", "containing", " ", "the", " ", 
       "votes", " ", "for", " ", "each", " ", 
       RowBox[{"prime", ".", "\[IndentingNewLine]", "Here"}], " ", "we", " ", 
       "are", " ", "interested", " ", "in", " ", "the", " ", "vote", " ", 
       "for", " ", "a", " ", "prime", " ", "so", " ", "we", " ", "take", " ", 
       "the", " ", "second", " ", "element", " ", "and", " ", "herein", " ", 
       "the", " ", "number", " ", "at", " ", "primeVoteIndex", " ", "using", 
       " ", "a", " ", "Map", " ", "call"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"votes", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "primeVoteIndex", " ", "]"}], "]"}], "&"}], ",", 
           RowBox[{"DynamicVoteList", "[", 
            RowBox[{"tuple", ",", " ", "count"}], "]"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FirstBadPosition", "[", 
          RowBox[{"votes", ",", " ", "tuple"}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Opacity", "[", "0.6", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "\"\<First bad digit in vote divided by length for \>\"", " ", "<>",
            " ", 
           RowBox[{"ToString", "[", "tuple", "]"}], " ", "<>", " ", 
           "\"\<(\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
           "\"\< values) - vote for \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"tuple", "[", 
             RowBox[{"[", "primeVoteIndex", "]"}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<N th vote\>\"", ",", "  ", 
            "\"\<Ratio position first bad / length representation\>\""}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",", " ", 
            RowBox[{"FontSize", "\[Rule]", "Larger"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5003166335631657`*^9, 3.500316665004964*^9}, {
   3.5003169466160717`*^9, 3.5003169818220854`*^9}, {3.500318294814184*^9, 
   3.500318299671462*^9}, 3.5003191633008585`*^9, 3.500365485372244*^9, {
   3.5003655688690195`*^9, 3.5003656099803715`*^9}, {3.500369039786545*^9, 
   3.500369040119564*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DigitsWithPositions", "[", 
   RowBox[{"vote_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"With", " ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"digits", " ", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"vote", ",", "p"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "  ", "[", "digits", "]"}], "+", "1", " ", "-", 
         " ", "n"}], ",", " ", 
        RowBox[{"digits", "[", 
         RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "  ", "[", "digits", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], " "}]], "Input",
 CellChangeTimes->{{3.5006289700505505`*^9, 3.5006291016940804`*^9}, {
  3.50062918718297*^9, 3.50062919959768*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AllBadPositions", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", "3", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.500629111441638*^9, 3.50062914068231*^9}, {
   3.5006293511753497`*^9, 3.5006293715225134`*^9}, {3.5006295887009354`*^9, 
   3.5006296134773526`*^9}, 3.500638247653199*^9, 3.500644053856295*^9, {
   3.500644300377395*^9, 3.5006443202945347`*^9}}],

Cell[BoxData[
 RowBox[{"AllBadPositions", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", "3", "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.5006291412843447`*^9, 3.500629203823922*^9, 3.5006293729915977`*^9, 
   3.500629452915169*^9, {3.500629495321594*^9, 3.5006295258953433`*^9}, {
   3.500629571766967*^9, 3.500629615412463*^9}, {3.5006296525385866`*^9, 
   3.5006296713136606`*^9}, {3.5006297512522326`*^9, 3.500629760099739*^9}, {
   3.500629846063656*^9, 3.5006298630506277`*^9}, {3.5006299416961255`*^9, 
   3.500629959057119*^9}, 3.5006301978697777`*^9, 3.500630584857912*^9, 
   3.5006321349155707`*^9, 3.5006334784504166`*^9, 3.5006343123871145`*^9, 
   3.5006345530988827`*^9, 3.500634661303072*^9, 3.500637595238883*^9, 
   3.5006378222958703`*^9, 3.5006380065694103`*^9, 3.5006382490622797`*^9, 
   3.5006410591290064`*^9, {3.5006440563284364`*^9, 3.50064410656431*^9}, {
   3.50064415167589*^9, 3.500644175175234*^9}, {3.500644232846533*^9, 
   3.5006442617011833`*^9}, {3.5006442935530047`*^9, 3.500644343770877*^9}, 
   3.500658611519946*^9, 3.500658723152331*^9, 3.5006602475635223`*^9, 
   3.5006619077014766`*^9, 3.5006659884898844`*^9, 3.500669436075075*^9, 
   3.5007864080244875`*^9, 3.5008689075025787`*^9, 3.5008726287502956`*^9, 
   3.500876588596786*^9, 3.500992996297604*^9, 3.500994021578247*^9, 
   3.5010565177038207`*^9, 3.5010896843188477`*^9, 3.5011908656962824`*^9, 
   3.5011951982447586`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DigitsWithPositions", "[", 
  RowBox[{"1000", ",", " ", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.500644192707237*^9, 3.50064419834956*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"7", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.500644199178607*^9, 3.5006586115419474`*^9, 
  3.5006587231813326`*^9, 3.5006602475855236`*^9, 3.500661907726478*^9, 
  3.5006659885088854`*^9, 3.5006694361160774`*^9, 3.500786408044489*^9, 
  3.500868907533779*^9, 3.5008726287682967`*^9, 3.5008765886177874`*^9, 
  3.500992996316605*^9, 3.500994021598248*^9, 3.5010565177358227`*^9, 
  3.5010896843468494`*^9, 3.5011908657274823`*^9, 3.501195198275959*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllBadPositions", "[", 
   RowBox[{"votes_", ",", " ", "tuple_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"vIndex", ",", "100"}], "]"}], "\[Equal]", "0"}], ",", 
           " ", 
           RowBox[{"PrintTemporary", "[", 
            RowBox[{"\"\<All bad \>\"", " ", "<>", " ", 
             RowBox[{"ToString", "[", "vIndex", "]"}], " ", "<>", " ", 
             "\"\< / \>\"", " ", "<>", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
             "\"\< for prime \>\"", " ", "<>", " ", 
             RowBox[{"ToString", "[", "p", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Map", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vIndex", ",", 
              RowBox[{"#", " ", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], 
            RowBox[{"(*", 
             RowBox[{"/", " ", 
              RowBox[{"Log", "[", 
               RowBox[{"p", ",", 
                RowBox[{
                 RowBox[{"votes", "[", 
                  RowBox[{"[", "vIndex", "]"}], "]"}], "+", "p", "-", "1"}]}],
                "]"}]}], "*)"}], "&"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Select", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"DigitsWithPositions", "[", 
              RowBox[{
               RowBox[{"votes", "[", 
                RowBox[{"[", "vIndex", "]"}], "]"}], ",", " ", "p"}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p", "+", "1"}], ")"}], "/", "2"}]}], "&"}], "]"}],
               "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p", "+", "1"}], ")"}], "/", "2"}]}], "&"}]}], 
            "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"vIndex", ",", "1", ",", 
          RowBox[{"Length", "[", "votes", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", "tuple"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
    ",", "\[IndentingNewLine]", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5006289330144324`*^9, 3.5006289371986713`*^9}, {
   3.5006292569659615`*^9, 3.5006293418048143`*^9}, {3.5006294239695134`*^9, 
   3.500629447794876*^9}, {3.500629480609753*^9, 3.500629566261652*^9}, {
   3.500629629185251*^9, 3.500629666203368*^9}, {3.5006297363113785`*^9, 
   3.5006297562445183`*^9}, {3.500629791783551*^9, 3.5006298212362356`*^9}, {
   3.5006298573663025`*^9, 3.500629954932883*^9}, {3.5006300127261887`*^9, 
   3.5006301938765497`*^9}, 3.500630280380497*^9, {3.5006313473375235`*^9, 
   3.5006313826775455`*^9}, 3.5006316186410418`*^9, {3.5006316943063693`*^9, 
   3.5006316963524866`*^9}, {3.5006321695365505`*^9, 
   3.5006321708536263`*^9}, {3.5006322952737427`*^9, 3.500632306682395*^9}, 
   3.5006382871984615`*^9, {3.5006439176985073`*^9, 3.5006439246169033`*^9}, {
   3.5006440685181336`*^9, 3.5006441034311304`*^9}, {3.500644146133573*^9, 
   3.5006441700219393`*^9}, {3.5006442161415772`*^9, 3.500644288967743*^9}, 
   3.500644339599639*^9, {3.500657029178441*^9, 3.500657029434456*^9}, {
   3.500657066875597*^9, 3.5006570904119434`*^9}, 3.500657442594087*^9, {
   3.500666521529372*^9, 3.500666535463169*^9}, {3.50066677272474*^9, 
   3.500666774871863*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllBadPositionGraphFor", "[", 
   RowBox[{"tuple_", ",", " ", "count_", ",", " ", "plotTuple_"}], "]"}], " ",
   ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"votes", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
           RowBox[{"DynamicVoteList", "[", 
            RowBox[{"tuple", ",", " ", "count"}], "]"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"votes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", " ", "p"}], "]"}], 
                "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "1", ",", " ", 
                 RowBox[{"Length", "[", "votes", "]"}]}], "}"}]}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.4", "]"}], ",", "Red"}], "]"}]}]}],
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", " ", 
           RowBox[{"{", 
            RowBox[{"p", ",", " ", "plotTuple"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"AllBadPositions", "[", 
              RowBox[{"votes", ",", "plotTuple"}], " ", "]"}], ",", "1"}], 
            "]"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"ColorFunction", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Opacity", "[", "0.2", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]",
           "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",", " ", 
            RowBox[{"FontSize", "\[Rule]", "Larger"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<N th voted value\>\"", ",", "  ", "\"\<Bad digit\>\""}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "\"\<All bad digits in voted value for tuple \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", "tuple", "]"}], " ", "<>", " ", 
           "\"\<\\n(\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
           "\"\< values)\\nLargest voted value (log10):\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"N", "[", 
             RowBox[{"Log", "[", 
              RowBox[{"10", ",", 
               RowBox[{"votes", "[", 
                RowBox[{"[", "count", "]"}], "]"}]}], "  ", "]"}], "]"}], 
            "]"}], " ", "<>", " ", "\"\<\\nPlotted for :\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", "plotTuple", "]"}]}]}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.500629977465172*^9, 3.5006299895748644`*^9}, {
   3.500630311093254*^9, 3.5006303405439386`*^9}, {3.5006303939439926`*^9, 
   3.5006303996913214`*^9}, {3.500630495744816*^9, 3.5006305365501494`*^9}, 
   3.500630644508324*^9, {3.5006323951974583`*^9, 3.5006324024608736`*^9}, {
   3.5006324437972374`*^9, 3.500632460934218*^9}, {3.5006347882473326`*^9, 
   3.5006349099762955`*^9}, {3.5006349970922775`*^9, 
   3.5006350028666077`*^9}, {3.5006397252087107`*^9, 
   3.5006397333321753`*^9}, {3.500640992590201*^9, 3.500640995108345*^9}, {
   3.500641072722784*^9, 3.5006410752129264`*^9}, {3.5006439806701093`*^9, 
   3.500643985734399*^9}, {3.500658984779295*^9, 3.500659020971365*^9}, {
   3.500659110796503*^9, 3.500659117197869*^9}, 3.5006595932850995`*^9, {
   3.500660006533736*^9, 3.5006600188464403`*^9}, 3.5006601196572065`*^9, {
   3.50066049928692*^9, 3.5006605497208047`*^9}, 3.5006606183067274`*^9, {
   3.5006610775169926`*^9, 3.5006610873595552`*^9}, {3.5006611432157507`*^9, 
   3.500661169275241*^9}, {3.5006624684475493`*^9, 3.500662469713622*^9}, 
   3.5006625637470007`*^9, {3.500665604356913*^9, 3.5006656160655828`*^9}, {
   3.500666568273046*^9, 3.5006666205330353`*^9}, {3.5006666782803383`*^9, 
   3.5006666923071404`*^9}}],

Cell["\<\
Calculating bad positions takes time.  We need it both for graphing votes and \
voted values.  Therefore we write a simple function that does the calculation \
and gives feedback for large calculations.
It also allows us to change both graph types at once.\
\>", "Text",
 CellChangeTimes->{{3.5003651311959867`*^9, 3.500365220915118*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountBadPosition", "[", 
   RowBox[{"votes_", ",", " ", "tuple_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"vIndex", ",", "10000"}], "]"}], "\[Equal]", "0"}], ",", " ", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Count bad \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "vIndex", "]"}], " ", "<>", " ", 
         "\"\< / \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
         "\"\< for prime \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "p", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"With", " ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"digs", "=", 
         RowBox[{"IntegerDigits", "[", 
          RowBox[{
           RowBox[{"votes", "[", 
            RowBox[{"[", "vIndex", "]"}], "]"}], ",", "p"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"digs", ",", 
            RowBox[{
             RowBox[{"#", ">=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p", "+", "1"}], ")"}], "/", "2"}]}], "&"}]}], "]"}], 
          "]"}], " ", "/", " ", 
         RowBox[{"Length", "[", "digs", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"p", ",", "tuple"}], "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"vIndex", ",", "1", ",", 
      RowBox[{"Length", "[", "votes", "]"}]}], "}"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.500362109145235*^9, 3.500362289247552*^9}, {
   3.5003625343551826`*^9, 3.500362554104817*^9}, {3.5003626598886027`*^9, 
   3.5003626948170643`*^9}, {3.5003627804456143`*^9, 3.500362784844822*^9}, {
   3.5003628650445633`*^9, 3.5003628711129737`*^9}, {3.500363594787109*^9, 
   3.500363614408231*^9}, {3.5005430911155567`*^9, 3.500543121575299*^9}, 
   3.5006100711235943`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountBadPositionGraphFor", "[", 
   RowBox[{"tuple_", ",", " ", "count_"}], "]"}], ":=", 
  RowBox[{"CountBadPositionGraphFor", "[", 
   RowBox[{"tuple", ",", " ", "count", ",", " ", "tuple"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5005435857458477`*^9, 3.500543605902001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountBadPositionGraphFor", "[", 
   RowBox[{"tuple_", ",", " ", "count_", ",", " ", "plotTuple_"}], "]"}], " ",
   ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"votes", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
           RowBox[{"DynamicVoteList", "[", 
            RowBox[{"tuple", ",", " ", "count"}], "]"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CountBadPosition", "[", 
          RowBox[{"votes", ",", "plotTuple"}], " ", "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Opacity", "[", "0.6", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "\"\<count bad digits in voted value divided by length for \>\"", 
           " ", "<>", " ", 
           RowBox[{"ToString", "[", "tuple", "]"}], " ", "<>", " ", 
           "\"\<\\n(\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
           "\"\< values)\\nLargest voted value (log10):\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"N", "[", 
             RowBox[{"Log", "[", 
              RowBox[{"10", ",", 
               RowBox[{"votes", "[", 
                RowBox[{"[", "count", "]"}], "]"}]}], "  ", "]"}], "]"}], 
            "]"}], " ", "<>", " ", "\"\<\\nPlotted for :\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", "plotTuple", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<N th vote\>\"", ",", "  ", 
            "\"\<Count bad / length representation\>\""}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",", " ", 
            RowBox[{"FontSize", "\[Rule]", "Larger"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQHXoy8qWjyCvHvR0nX4PoRVlTzd2BdN2OLGsQvfAB
o0YwkJbYpAGmQ9u4LUKA9Ac1NzD9hM19YxZIvWbAJhCd8jB6Yg6Q9m5MA9N3
+AzX1wLpNexLN4LoIzKLtoLoB88vbgPRe+LltBtB6oTddUF0qa1G40EgXWMw
twlEmxx80g6ifUzKe0F0xc09k0D0mjTHySDa7MnFlSC6rUl4NYh2cuXaAKJP
NWhvBNHTTy/bCaJr7QV3g+gY+6AjIDpsq9FREG1wSfMUiL7imQKmj03uvQii
C2SmXwbRJy73CT8F6eNXFwHRDW883z4D6fPQ+QyiAQ0xmTY=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountBadPositionGraphForPrimeVote", "[", 
   RowBox[{"tuple_", ",", " ", "count_", ",", " ", "primeVoteIndex_"}], "]"}],
   " ", ":=", " ", 
  RowBox[{"CountBadPositionGraphForPrimeVote", "[", 
   RowBox[{
   "tuple", ",", " ", "count", ",", " ", "primeVoteIndex", ",", " ", 
    "tuple"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5006258285168653`*^9, 3.5006258384304323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountBadPositionGraphForPrimeVote", "[", 
   RowBox[{
   "tuple_", ",", " ", "count_", ",", " ", "primeVoteIndex_", ",", " ", 
    "plotTuple_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"votes", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "primeVoteIndex", " ", "]"}], "]"}], "&"}], ",", 
           RowBox[{"DynamicVoteList", "[", 
            RowBox[{"tuple", ",", " ", "count"}], "]"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CountBadPosition", "[", 
          RowBox[{"votes", ",", " ", "plotTuple"}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Opacity", "[", "0.6", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "\"\<count bad digits in vote divided by length for \>\"", " ", "<>",
            " ", 
           RowBox[{"ToString", "[", "tuple", "]"}], " ", "<>", " ", 
           "\"\<\\n(\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
           "\"\< values)\\nvote for \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"tuple", "[", 
             RowBox[{"[", "primeVoteIndex", "]"}], "]"}], "]"}], "<>", " ", 
           "\"\<\\nPlotted for :\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", "plotTuple", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<N th vote\>\"", ",", "  ", 
            "\"\<Count bad / length representation\>\""}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",", " ", 
            RowBox[{"FontSize", "\[Rule]", "Larger"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5002816748058267`*^9, 3.5002816942979417`*^9}, {
   3.5002925406692667`*^9, 3.500292571335021*^9}, {3.5003166939166183`*^9, 
   3.500316712202664*^9}, 3.5003170044773808`*^9, {3.500318305336786*^9, 
   3.5003183066758623`*^9}, {3.5003191748775206`*^9, 3.500319177091647*^9}, {
   3.500362466354663*^9, 3.5003624745134773`*^9}, {3.500369030135993*^9, 
   3.5003690304130087`*^9}, {3.5003980314005585`*^9, 3.500398043345242*^9}, {
   3.500625846594899*^9, 3.5006258878052564`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalBadPosition", "[", 
   RowBox[{"votes_", ",", " ", "tuple_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"vIndex", ",", "10000"}], "]"}], "\[Equal]", "0"}], ",", " ", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Total bad \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "vIndex", "]"}], " ", "<>", " ", 
         "\"\< / \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
         "\"\< for prime \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "p", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"With", " ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"digs", "=", 
         RowBox[{"IntegerDigits", "[", 
          RowBox[{
           RowBox[{"votes", "[", 
            RowBox[{"[", "vIndex", "]"}], "]"}], ",", "p"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"digs", ",", 
           RowBox[{
            RowBox[{"#", "<=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "+", "1"}], ")"}], "/", "2"}]}], "&"}]}], "]"}], 
         "]"}], " ", "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"p", ",", "tuple"}], "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"vIndex", ",", "1", ",", 
      RowBox[{"Length", "[", "votes", "]"}]}], "}"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.5003785004826655`*^9, 3.5003785235769863`*^9}, {
  3.50065658857624*^9, 3.500656588781252*^9}, {3.5006570163347063`*^9, 
  3.5006570167097282`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalBadPositionGraphFor", "[", 
   RowBox[{"tuple_", ",", " ", "count_"}], "]"}], " ", ":=", " ", 
  RowBox[{"TotalBadPositionGraphFor", "[", 
   RowBox[{"tuple", ",", " ", "count", ",", "  ", "tuple"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.500644888093011*^9, 3.5006448971785307`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalBadPositionGraphFor", "[", 
   RowBox[{"tuple_", ",", " ", "count_", ",", " ", "plotTuple_"}], "]"}], " ",
   ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"votes", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
           RowBox[{"DynamicVoteList", "[", 
            RowBox[{"tuple", ",", " ", "count"}], "]"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TotalBadPosition", "[", 
          RowBox[{"votes", ",", " ", "plotTuple"}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Opacity", "[", "0.6", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{
          "\"\<Total count bad digits length for \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", "tuple", "]"}], " ", "<>", " ", 
           "\"\<\\n(\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "votes", "]"}], "]"}], "<>", " ", 
           "\"\< values)\\nPlotted for :\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", "plotTuple", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<N th vote\>\"", ",", "  ", "\"\<Total bad\>\""}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",", " ", 
            RowBox[{"FontSize", "\[Rule]", "Larger"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5003785384668384`*^9, 3.500378579127164*^9}, {
  3.5006449037239046`*^9, 3.50064493983097*^9}, {3.5006449884477506`*^9, 
  3.500644988711766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CumulativeVoteGraphFor", "[", 
   RowBox[{"tuple_", ",", " ", "count_", ",", " ", "primeIndex_"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"votesForPrime", "=", 
         RowBox[{"Accumulate", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "primeIndex", "]"}], "]"}], "&"}], ",", 
            RowBox[{"DynamicVoteList", "[", 
             RowBox[{"tuple", ",", " ", "count"}], "]"}]}], "]"}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{"votesForPrime", ",", " ", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Opacity", "[", "0.6", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"\"\<Logplot of cummulative votes \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", "tuple", "]"}], " ", "<>", " ", 
           "\"\<(\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "votesForPrime", "]"}], "]"}], "<>", " ", 
           "\"\< values) - vote for prime\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"tuple", "[", 
             RowBox[{"[", "primeIndex", "]"}], "]"}], " ", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<N th vote\>\"", ",", "  ", "\"\<Total bad\>\""}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "\"\<Calibri\>\""}], ",", " ", 
            RowBox[{"FontSize", "\[Rule]", "Larger"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.500394442075396*^9, 3.5003945965156674`*^9}, {
  3.5003946632369843`*^9, 3.5003946637829857`*^9}, {3.5003947246854925`*^9, 
  3.5003947354495115`*^9}}],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{"magicGraham", "(", "primeList_", ")"}], ":=", 
    RowBox[{
     RowBox[{
      UnderoverscriptBox["\[Sum]", "p", "primeList"], 
      FractionBox[
       RowBox[{"log", "(", 
        FractionBox[
         RowBox[{"p", "+", "1"}], 
         RowBox[{"2", " ", "p"}]], ")"}], 
       RowBox[{"log", "(", "p", ")"}]]}], "+", "1"}]}],
   FontFamily->"Consolas",
   FontSize->24], TraditionalForm]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FileNameForVotedValuesSummary", "[", "range_", "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "result", " ", "=", " ", "\"\<d:\\\\Triangle\\\\Votes\\\\Summary\>\""}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"DirectoryQ", "[", "result", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"CreateDirectory", "[", "result", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{
      "result", " ", "<>", " ", "\"\<\\\\VotedValuesAtHeight-\>\"", " ", "<>",
        " ", 
       RowBox[{"ToString", "[", "range", "]"}], " ", "<>", " ", 
       "\"\<.txt\>\""}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.501236879907323*^9, 3.5012370187382636`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CalcVotedValuesSummaryForRange", "[", 
   RowBox[{"tupleList_", ",", " ", "range_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tuplePos", ",", " ", "tuple", ",", " ", "fileName", ",", " ", "values", 
      ",", " ", "found", ",", " ", "doneTuples", ",", " ", "votesVector"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "first", " ", "read", " ", "whatever", " ", "has", " ", "been", " ", 
      "written", " ", "before"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fileName", " ", "=", " ", 
      RowBox[{"FileNameForVotedValuesSummary", "[", "range", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "fileName", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"values", " ", "=", " ", 
        RowBox[{"ReadList", "[", 
         RowBox[{"fileName", ",", " ", "Expression"}], "]"}]}], 
       "\[IndentingNewLine]", ",", " ", 
       RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"values", " ", "=", 
        RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "retrieve", " ", "a", " ", "list", " ", "of", " ", "just", " ", "the", 
       " ", "tuples"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"doneTuples", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", " ", "values"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"now", " ", "loop", " ", "over", " ", "all", " ", "tuples"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"tuplePos", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"tuplePos", " ", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "tupleList", "]"}]}], ",", " ", 
         RowBox[{"tuplePos", " ", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tuple", " ", "=", " ", 
           RowBox[{"Sort", "[", 
            RowBox[{"tupleList", "[", 
             RowBox[{"[", "tuplePos", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"found", " ", "=", " ", "False"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ArrayDepth", "[", 
              RowBox[{"Position", "[", 
               RowBox[{"doneTuples", ",", " ", "tuple"}], "]"}], "]"}], 
             "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "found", " ", "*)"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"(*", "else", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"votesVector", " ", "=", " ", 
              RowBox[{"DynamicVoteList", "[", 
               RowBox[{"tuple", ",", " ", "range"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"doneTuples", " ", "=", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"doneTuples", ",", " ", "tuple"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"f", "=", " ", 
                 RowBox[{"OpenAppend", "[", 
                  RowBox[{"fileName", ",", " ", 
                   RowBox[{"PageWidth", "\[Rule]", "40000"}]}], "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Print", " ", "[", 
                  RowBox[{"\"\<Writing : \>\"", " ", "<>", " ", "fileName"}], 
                  "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Write", "[", 
                 RowBox[{"f", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"tuple", ",", " ", 
                    RowBox[{
                    RowBox[{"Last", "[", "votesVector", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Close", "[", "f", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ToString", "[", "tuplePos", "]"}], " ", "<>", " ", 
        "\"\< - \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "tuple", "]"}], " ", "<>", " ", 
        "\"\< - \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "found", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"ReadList", "[", 
       RowBox[{"fileName", ",", " ", "Expression"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"]
},
WindowSize->{1904, 945},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (January 30, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 1536, 35, 212, "Input"],
Cell[2084, 57, 5698, 135, 732, "Input"],
Cell[7785, 194, 2235, 50, 312, "Input"],
Cell[10023, 246, 2042, 47, 312, "Input"],
Cell[12068, 295, 2044, 47, 312, "Input"],
Cell[14115, 344, 2012, 37, 152, "Input"],
Cell[16130, 383, 1325, 32, 172, "Input"],
Cell[17458, 417, 1105, 27, 152, "Input"],
Cell[18566, 446, 3026, 63, 192, "Input"],
Cell[21595, 511, 4464, 112, 372, "Input"],
Cell[26062, 625, 7751, 157, 772, "Input"],
Cell[33816, 784, 6931, 149, 872, "Input"],
Cell[40750, 935, 748, 12, 31, "Input"],
Cell[41501, 949, 18725, 384, 1872, "Input"],
Cell[60229, 1335, 10532, 205, 752, "Input"],
Cell[CellGroupData[{
Cell[70786, 1544, 143, 1, 23, "Item"],
Cell[70932, 1547, 398, 7, 39, "Item"]
}, Open  ]],
Cell[71345, 1557, 1243, 29, 192, "Input"],
Cell[72591, 1588, 348, 6, 47, "Text"],
Cell[72942, 1596, 2122, 50, 172, "Input"],
Cell[75067, 1648, 317, 6, 31, "Input"],
Cell[75387, 1656, 4205, 85, 412, "Input"],
Cell[79595, 1743, 3966, 81, 392, "Input"],
Cell[83564, 1826, 927, 24, 72, "Input"],
Cell[CellGroupData[{
Cell[84516, 1854, 433, 9, 31, "Input"],
Cell[84952, 1865, 1478, 24, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86467, 1894, 168, 3, 31, "Input"],
Cell[86638, 1899, 895, 22, 30, "Output"]
}, Open  ]],
Cell[87548, 1924, 4215, 90, 312, "Input"],
Cell[91766, 2016, 5559, 112, 592, "Input"],
Cell[97328, 2130, 348, 6, 47, "Text"],
Cell[97679, 2138, 2262, 54, 172, "Input"],
Cell[99944, 2194, 315, 6, 31, "Input"],
Cell[100262, 2202, 3345, 74, 372, "Input"],
Cell[103610, 2278, 414, 9, 31, "Input"],
Cell[104027, 2289, 3436, 73, 352, "Input"],
Cell[107466, 2364, 1945, 49, 172, "Input"],
Cell[109414, 2415, 326, 6, 31, "Input"],
Cell[109743, 2423, 2694, 59, 352, "Input"],
Cell[112440, 2484, 2822, 60, 352, "Input"],
Cell[115265, 2546, 464, 15, 100, "Input"],
Cell[115732, 2563, 1013, 24, 172, "Input"],
Cell[116748, 2589, 5205, 116, 672, "Input"]
}
]
*)

(* End of internal cache information *)
