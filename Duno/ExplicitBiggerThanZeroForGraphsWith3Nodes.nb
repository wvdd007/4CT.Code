(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45214,       1177]
NotebookOptionsPosition[     43256,       1107]
NotebookOutlinePosition[     43596,       1122]
CellTagsIndexPosition[     43553,       1119]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetWhy", "[", 
   RowBox[{"key_", ",", "comp_", ",", "why_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"newAssoc", "[", "key", "]"}], "[", "\"\<comp\>\"", "]"}], "=",
       "comp"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"newAssoc", "[", "key", "]"}], "[", "\"\<compwhy\>\"", "]"}], 
      "=", "why"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6712585974970117`*^9, 3.671258667316325*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"SetWhy", "[", 
     RowBox[{"#", ",", "Greater", ",", "\"\<IH\>\""}], "]"}], "&"}], ",", 
   RowBox[{"Keys", "[", "newAssoc", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6712790199754224`*^9, 3.6712790218165145`*^9}, {
   3.6712791199636183`*^9, 3.671279422134427*^9}, {3.6714605371884117`*^9, 
   3.671460631319606*^9}, {3.6714606636508217`*^9, 3.671460769617671*^9}, 
   3.671463071664056*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"IH\"\>", ",", "\<\"IH\"\>", ",", "\<\"IH\"\>", 
   ",", "\<\"IH\"\>", ",", "\<\"IH\"\>", ",", "\<\"IH\"\>", ",", "\<\"IH\"\>",
    ",", "\<\"IH\"\>", ",", "\<\"IH\"\>", ",", "\<\"IH\"\>", 
   ",", "\<\"IH\"\>", ",", "\<\"IH\"\>", ",", "\<\"IH\"\>", ",", "\<\"IH\"\>",
    ",", "\<\"IH\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.6712791511822543`*^9, 3.671279169486362*^9}, 
   3.6712793771874027`*^9, 3.671279433076271*^9, 3.6712963817387686`*^9, 
   3.671460771036063*^9, 3.6714630778749313`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CosyPrint2", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.6712796375396214`*^9, 3.6712796442881775`*^9}}],

Cell[BoxData[
 FrameBox[
  TemplateBox[{TemplateBox[{
      GraphicsBox[
       NamespaceBox["NetworkGraphics", 
        DynamicModuleBox[{Typeset`graph = HoldComplete[
            
            Graph[{1, 2, 3, 4, 5}, {}, {
             GraphLayout -> {"Dimension" -> 2}, ImageSize -> {50, 50}, 
              VertexCoordinates -> {{-0.9510565162951535, 
               0.30901699437494745`}, {-0.5877852522924731, \
-0.8090169943749475}, {0.5877852522924731, -0.8090169943749475}, {
               0.9510565162951535, 0.30901699437494745`}, {0., 1.}}, 
              VertexLabels -> {
               4 -> "4", 2 -> "2", 1 -> "1", 3 -> "3", 5 -> "5"}, 
              VertexSize -> {Normal}}]]}, 
         TagBox[
          GraphicsGroupBox[{{}, {
             Directive[
              Hue[0.6, 0.2, 0.8], 
              EdgeForm[
               Directive[
                GrayLevel[0], 
                Opacity[0.7]]]], {
              
              DiskBox[{-0.9510565162951535, 0.30901699437494745`}, 
               0.021812234931106983`], 
              InsetBox[
               FormBox["\"1\"", TraditionalForm], 
               Offset[{2, 2}, {-0.9292442813640466, 0.3308292293060544}], 
               ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, {
              
              DiskBox[{-0.5877852522924731, -0.8090169943749475}, 
               0.021812234931106983`], 
              InsetBox[
               FormBox["\"2\"", TraditionalForm], 
               Offset[{2, 2}, {-0.5659730173613662, -0.7872047594438405}], 
               ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, {
              
              DiskBox[{0.5877852522924731, -0.8090169943749475}, 
               0.021812234931106983`], 
              InsetBox[
               FormBox["\"3\"", TraditionalForm], 
               Offset[{2, 2}, {0.6095974872235801, -0.7872047594438405}], 
               ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, {
              
              DiskBox[{0.9510565162951535, 0.30901699437494745`}, 
               0.021812234931106983`], 
              InsetBox[
               FormBox["\"4\"", TraditionalForm], 
               Offset[{2, 2}, {0.9728687512262605, 0.3308292293060544}], 
               ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, {
              DiskBox[{0., 1.}, 0.021812234931106983`], 
              InsetBox[
               FormBox["\"5\"", TraditionalForm], 
               Offset[{2, 2}, {0.021812234931106983`, 1.021812234931107}], 
               ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}}}], 
          MouseAppearanceTag["NetworkGraphics"]], AllowKernelInitialization -> 
         False]], {FrameTicks -> None, GridLinesStyle -> Directive[
          GrayLevel[0.5, 0.4]], ImageSize -> {50, 50}, 
        DefaultBaseStyle -> {
         "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
          Hue[0.8, 1., 0.6]}}], "\"   \"", 
      GraphicsBox[
       NamespaceBox["NetworkGraphics", 
        DynamicModuleBox[{Typeset`graph = HoldComplete[
            
            Graph[{1, 2, 3, 4, 5}, {}, {
             GraphLayout -> "TutteEmbedding", ImageSize -> {50, 50}}]]}, 
         TagBox[
          GraphicsGroupBox[
           
           GraphicsComplexBox[{{0.00001, -0.00005}, {0.00001, -0.00001}, {
            0.00001, -0.000030000000000000004`}, {
            0.000030000000000000004`, -0.00001}, {
            0.000030000000000000004`, -0.000030000000000000004`}}, {{}, {
              Directive[
               Hue[0.6, 0.2, 0.8], 
               EdgeForm[
                Directive[
                 GrayLevel[0], 
                 Opacity[0.7]]]], 
              DiskBox[1, 5.092*^-7], 
              DiskBox[2, 5.092*^-7], 
              DiskBox[3, 5.092*^-7], 
              DiskBox[4, 5.092*^-7], 
              DiskBox[5, 5.092*^-7]}}]], 
          MouseAppearanceTag["NetworkGraphics"]], AllowKernelInitialization -> 
         False]], {FrameTicks -> None, GridLinesStyle -> Directive[
          GrayLevel[0.5, 0.4]], ImageSize -> {50, 50}, 
        DefaultBaseStyle -> {
         "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
          Hue[0.8, 1., 0.6]}}], "\"   \"", 
      StyleBox[
       TagBox[
        TagBox[
         GridBox[{{
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x19683", "+", "x39366"}]}]}, {
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x13122", "+", "x6561"}]}]}, {
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x2187", "+", "x4374"}]}]}, {
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x1458", "+", "x729"}]}]}, {
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x243", "+", "x486"}]}]}, {
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x162", "+", "x81"}]}]}, {
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x27", "+", "x54"}]}]}, {
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x18", "+", "x9"}]}]}, {
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x3", "+", "x6"}]}]}, {
            RowBox[{"x0", "\[Equal]", 
              RowBox[{"x1", "+", "x2"}]}]}}, RowSpacings -> 1, 
          ColumnAlignments -> Left, ColumnAlignments -> Left], Column], 
        Function[BoxForm`e$, 
         TableForm[BoxForm`e$]]], FontSize -> 12, FontFamily -> "Consolas", 
       StripOnInput -> False], "\"   \"", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", 
         GridBox[{{"2", "0", "0", "0", "0"}, {"0", "2", "0", "0", "0"}, {
           "0", "0", "2", "0", "0"}, {"0", "0", "0", "2", "0"}, {
           "0", "0", "0", "0", "2"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
          RowAlignments -> Baseline, ColumnAlignments -> Center], 
         "\[NoBreak]", ")"}], 
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}, "RowDefault"],StyleBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{"0", "\[Rule]", 
           RowBox[{
             TagBox[
              FormBox["z", TraditionalForm], TraditionalForm, Editable -> 
              True], ">", "0"}]}], ",", "\"IH\""}], "}"}], 
     RGBColor[1, 0, 0], StripOnInput -> False]},
   "Labeled",
   DisplayFunction->(GridBox[{{
       TagBox[
        ItemBox[
         PaneBox[
          TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
          BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
        "SkipImageSizeLevel"]}, {
       ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
     GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
     AutoDelete -> False, 
     GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
      BaselinePosition -> {1, 1}]& ),
   InterpretationFunction->(RowBox[{"Labeled", "[", 
      RowBox[{#, ",", #2}], "]"}]& )],
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.671279645766141*^9, 3.671281937242968*^9, {3.671281992280938*^9, 
   3.6712820128325195`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"xyz", "=", 
   RowBox[{"Fold", "[", 
    RowBox[{"And", ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"current", "=", 
           RowBox[{"newAssoc", "[", "key", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"op", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{"current", ",", "\"\<comp\>\""}], "]"}], ",", 
                RowBox[{"current", "[", "\"\<comp\>\"", "]"}], ",", 
                "GreaterEqual"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"form", "=", 
              RowBox[{"current", "[", "\"\<colofour\>\"", "]"}]}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"op", "[", 
              RowBox[{"form", ",", "0"}], "]"}], "&&", 
             RowBox[{
              RowBox[{"Symbol", "[", 
               RowBox[{"\"\<x\>\"", "<>", 
                RowBox[{"ToString", "[", "key", "]"}]}], "]"}], "\[Equal]", 
              "form"}], " ", "&&", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"current", "[", "\"\<relations\>\"", "]"}], "==", 
                RowBox[{"{", "}"}]}], ",", "True", ",", " ", 
               RowBox[{"Fold", "[", 
                RowBox[{"And", ",", 
                 RowBox[{"current", "[", "\"\<relations\>\"", "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"key", ",", 
         RowBox[{"Keys", "[", "newAssoc", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
  RowBox[{"Length", "[", "xyz", "]"}]}]], "Input",
 CellChangeTimes->{{3.67128271682687*^9, 3.6712827182079163`*^9}, {
  3.6712827639881096`*^9, 3.671282828034048*^9}}],

Cell[BoxData["18499"], "Output",
 CellChangeTimes->{{3.6712827577065496`*^9, 3.671282823383896*^9}, 
   3.67128309372064*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.671282721728887*^9, 3.6712827258275676`*^9}, 
   3.6712828156765385`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{"xyz", ",", "x36166"}], "]"}]], "Input",
 CellChangeTimes->{{3.671282071282488*^9, 3.671282220352524*^9}, {
   3.6712822720243506`*^9, 3.6712823271812625`*^9}, {3.671282418029248*^9, 
   3.671282426260392*^9}, {3.6712826061169553`*^9, 3.671282614774596*^9}, 
   3.671282713871914*^9, {3.6712831108032246`*^9, 3.671283116755703*^9}, {
   3.671283147753187*^9, 3.6712831484386997`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.6712841387497454`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6712826193823986`*^9, 3.671282628619855*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"Keys", "[", "newAssoc", "]"}], ",", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{"myVars", ",", 
      RowBox[{
       RowBox[{"newAssoc", "[", "#", "]"}], "[", "\"\<colofour\>\"", "]"}]}], 
     "]"}], "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6712843026062965`*^9, 3.671284336200903*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "1", ",", "3", ",", "9", ",", "13", ",", "27", ",", "36", ",", 
   "81", ",", "84", ",", "109", ",", "243", ",", "244", ",", "273", ",", 
   "333", ",", "364", ",", "729", ",", "738", ",", "810", ",", "972", ",", 
   "1062", ",", "2187", ",", "2190", ",", "2214", ",", "2430", ",", "2460", 
   ",", "2917", ",", "3160", ",", "6561", ",", "6562", ",", "6588", ",", 
   "6642", ",", "6670", ",", "7293", ",", "7374", ",", "8757", ",", "8784", 
   ",", "9490", ",", "19683", ",", "19684", ",", "19686", ",", "19692", ",", 
   "19696", ",", "20439", ",", "20448", ",", "21951", ",", "21954", ",", 
   "22708", ",", "26487", ",", "26488", ",", "27246", ",", "28764"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6712843371153493`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CalcStructure", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"current", ",", " ", 
       RowBox[{"added", "=", 
        RowBox[{"{", "}"}]}], ",", " ", "combinations", ",", " ", "found", 
       ",", " ", "items", ",", " ", "others"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"current", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Keys", "[", "newAssoc", "]"}], ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"myVars", ",", 
             RowBox[{
              RowBox[{"newAssoc", "[", "#", "]"}], "[", "\"\<colofour\>\"", 
              "]"}]}], "]"}], "&"}]}], "]"}], "//", "Sort"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "current", "]"}], "\[Rule]", "current"}], 
        "}"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"combinations", "=", 
       RowBox[{"Subsets", "[", 
        RowBox[{"current", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"found", "=", "True"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{"found", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"found", "=", "False"}], ";", "\[IndentingNewLine]", 
         RowBox[{"others", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "newAssoc", "]"}], ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"current", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"items", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"others", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"newAssoc", "[", "#", "]"}], "[", 
                    "\"\<colofour\>\"", "]"}], "\[Equal]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newAssoc", "[", 
                    RowBox[{"pair", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                    "\"\<colofour\>\"", "]"}], "-", 
                    RowBox[{
                    RowBox[{"newAssoc", "[", 
                    RowBox[{"pair", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
                    "\"\<colofour\>\"", "]"}]}], ")"}]}], "&"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"added", "=", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"added", ",", "items"}], "]"}], "//", 
                "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"items", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"others", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"newAssoc", "[", "#", "]"}], "[", 
                    "\"\<colofour\>\"", "]"}], "\[Equal]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newAssoc", "[", 
                    RowBox[{"pair", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                    "\"\<colofour\>\"", "]"}], "+", 
                    RowBox[{
                    RowBox[{"newAssoc", "[", 
                    RowBox[{"pair", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
                    "\"\<colofour\>\"", "]"}]}], ")"}]}], "&"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"added", "=", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"added", ",", "items"}], "]"}], "//", 
                "DeleteDuplicates"}]}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"pair", ",", "combinations"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"pair", ",", 
             RowBox[{"Length", "[", "added", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"added", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"added", "=", 
             RowBox[{"Sort", "[", 
              RowBox[{"added", "//", "DeleteDuplicates"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "[", "added", "]"}], "\[Rule]", "added"}], 
              "}"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"current", "=", 
             RowBox[{"Sort", "[", 
              RowBox[{"Join", "[", 
               RowBox[{"current", ",", "added"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"combinations", "=", 
             RowBox[{"Subsets", "[", 
              RowBox[{"current", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"found", "=", "True"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"added", "=", 
          RowBox[{"{", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671284345110765*^9, 3.6712844498054314`*^9}, {
   3.671284496404437*^9, 3.6712847082472773`*^9}, {3.671284742656973*^9, 
   3.671284752585263*^9}, {3.671284786255564*^9, 3.6712848080719748`*^9}, {
   3.6712848810531263`*^9, 3.671284897496215*^9}, {3.671285120702016*^9, 
   3.6712851347731743`*^9}, 3.6712852190603857`*^9, 3.671285289423135*^9, {
   3.6712853266691475`*^9, 3.6712853565642943`*^9}, {3.6712853909219627`*^9, 
   3.6712854139190845`*^9}, {3.671285469654331*^9, 3.6712855030601034`*^9}, {
   3.6712855704270253`*^9, 3.6712855742064734`*^9}, {3.671285698174182*^9, 
   3.671285759417028*^9}, {3.6712858250181866`*^9, 3.6712858485380087`*^9}, {
   3.671286380528325*^9, 3.6712863853385487`*^9}, {3.671286466493087*^9, 
   3.6712865458851323`*^9}, {3.6712878717780533`*^9, 3.671287885129959*^9}, {
   3.6712889269021807`*^9, 3.6712889371331673`*^9}, 3.6712890175183706`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CalcStructure", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6712847195512753`*^9, 3.671284730553731*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3", ",", "9", ",", "26"}], "}"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{3.6714605022652025`*^9, 3.6714630833293962`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6", ",", "18"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6714605022652025`*^9, 3.67146308349504*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "16", ",", "22"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6714605022652025`*^9, 3.671463083661557*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "10", ",", "12"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6714605022652025`*^9, 3.6714630838303895`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", "\[Rule]", 
   RowBox[{"{", "13", "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6714605022652025`*^9, 3.671463083996426*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"Keys", "[", "newAssoc", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"newAssoc", "[", "#", "]"}], "[", "\"\<colofour\>\"", "]"}], 
     "\[Equal]", "t1"}], "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6712851677221413`*^9, 3.671285208104245*^9}}],

Cell[BoxData[
 RowBox[{"{", "1", "}"}]], "Output",
 CellChangeTimes->{{3.6712851855779343`*^9, 3.6712852087467937`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CosyPrint2", "[", "39384", "]"}]], "Input",
 CellChangeTimes->{{3.6712853632789106`*^9, 3.6712853786158805`*^9}, 
   3.671285941572568*^9, {3.671287838504649*^9, 3.6712878502971663`*^9}, 
   3.6712882933196993`*^9}],

Cell[BoxData[
 FrameBox[
  TemplateBox[{TemplateBox[{
      GraphicsBox[
       NamespaceBox["NetworkGraphics", 
        DynamicModuleBox[{Typeset`graph = HoldComplete[
            
            Graph[{1, 2, 3}, {}, {
             GraphLayout -> {"Dimension" -> 2}, ImageSize -> {50, 50}, 
              VertexCoordinates -> {{0., 1.}, {-0.47552825814757677`, 
               0.15450849718747373`}, {
               0.29389262614623657`, -0.4045084971874737}}, 
              VertexLabels -> {3 -> "3,4", 1 -> "5", 2 -> "1,2"}, 
              VertexSize -> {Normal}}]]}, 
         TagBox[
          GraphicsGroupBox[{{}, {
             Directive[
              Hue[0.6, 0.2, 0.8], 
              EdgeForm[
               Directive[
                GrayLevel[0], 
                Opacity[0.7]]]], {
              DiskBox[{0., 1.}, 0.017589203556513666`], 
              InsetBox[
               FormBox["\"5\"", TraditionalForm], 
               Offset[{2, 2}, {0.017589203556513666`, 1.0175892035565137`}], 
               ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, {
              
              DiskBox[{-0.47552825814757677`, 0.15450849718747373`}, 
               0.017589203556513666`], 
              InsetBox[
               FormBox["\"1,2\"", TraditionalForm], 
               Offset[{2, 2}, {-0.4579390545910631, 0.1720977007439874}], 
               ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, {
              
              DiskBox[{0.29389262614623657`, -0.4045084971874737}, 
               0.017589203556513666`], 
              InsetBox[
               FormBox["\"3,4\"", TraditionalForm], 
               Offset[{2, 2}, {0.31148182970275023`, -0.38691929363096006`}], 
               ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}}}], 
          MouseAppearanceTag["NetworkGraphics"]], AllowKernelInitialization -> 
         False]], {FrameTicks -> None, GridLinesStyle -> Directive[
          GrayLevel[0.5, 0.4]], ImageSize -> {50, 50}, 
        DefaultBaseStyle -> {
         "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
          Hue[0.8, 1., 0.6]}}], "\"   \"", 
      GraphicsBox[
       NamespaceBox["NetworkGraphics", 
        DynamicModuleBox[{Typeset`graph = HoldComplete[
            
            Graph[{1, 2, 3}, {}, {
             GraphLayout -> "TutteEmbedding", ImageSize -> {50, 50}}]]}, 
         TagBox[
          GraphicsGroupBox[
           
           GraphicsComplexBox[{{0.000030000000000000004`, -0.00001}, {
            0.00001, -0.00001}, {0.00001, -0.000030000000000000004`}}, {{}, {
              Directive[
               Hue[0.6, 0.2, 0.8], 
               EdgeForm[
                Directive[
                 GrayLevel[0], 
                 Opacity[0.7]]]], 
              DiskBox[1, 2.5460000000000007`*^-7], 
              DiskBox[2, 2.5460000000000007`*^-7], 
              DiskBox[3, 2.5460000000000007`*^-7]}}]], 
          MouseAppearanceTag["NetworkGraphics"]], AllowKernelInitialization -> 
         False]], {FrameTicks -> None, GridLinesStyle -> Directive[
          GrayLevel[0.5, 0.4]], ImageSize -> {50, 50}, 
        DefaultBaseStyle -> {
         "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
          Hue[0.8, 1., 0.6]}}], "\"   \"", 
      StyleBox[
       TagBox[
        TagBox[
         GridBox[{{
            RowBox[{"x39384", "\[Equal]", 
              RowBox[{"x40140", "+", "x40896"}]}]}, {
            RowBox[{"x39384", "\[Equal]", 
              RowBox[{"x39388", "+", "x39392"}]}]}, {
            RowBox[{"x39384", "\[Equal]", 
              RowBox[{"x48456", "+", "x57528"}]}]}}, RowSpacings -> 1, 
          ColumnAlignments -> Left, ColumnAlignments -> Left], Column], 
        Function[BoxForm`e$, 
         TableForm[BoxForm`e$]]], FontSize -> 12, FontFamily -> "Consolas", 
       StripOnInput -> False], "\"   \"", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", 
         GridBox[{{"2", "2", "0", "0", "0"}, {"2", "2", "0", "0", "0"}, {
           "0", "0", "2", "2", "0"}, {"0", "0", "2", "2", "0"}, {
           "0", "0", "0", "0", "2"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
          RowAlignments -> Baseline, ColumnAlignments -> Center], 
         "\[NoBreak]", ")"}], 
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}, "RowDefault"],StyleBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{"39384", "\[Rule]", 
           RowBox[{
             TagBox[
              FormBox[
               RowBox[{"k3", "-", "t2", "-", "t4", "+", "z"}], 
               TraditionalForm], TraditionalForm, Editable -> True], 
             "\[GreaterEqual]", "0"}]}], ",", "\"\""}], "}"}], 
     RGBColor[1, 0, 0], StripOnInput -> False]},
   "Labeled",
   DisplayFunction->(GridBox[{{
       TagBox[
        ItemBox[
         PaneBox[
          TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
          BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
        "SkipImageSizeLevel"]}, {
       ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
     GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
     AutoDelete -> False, 
     GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
      BaselinePosition -> {1, 1}]& ),
   InterpretationFunction->(RowBox[{"Labeled", "[", 
      RowBox[{#, ",", #2}], "]"}]& )],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.6712853687874303`*^9, 3.6712853793223057`*^9}, 
   3.6712865551278486`*^9, {3.6712878393520823`*^9, 3.6712878509718604`*^9}, 
   3.6712882961499476`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CalcStructure2", "[", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"current", ",", " ", 
      RowBox[{"added", "=", 
       RowBox[{"{", "}"}]}], ",", " ", "combinations", ",", " ", "found", ",",
       " ", "items", ",", " ", "crit"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"current", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Keys", "[", "newAssoc", "]"}], ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"myVars", ",", 
           RowBox[{
            RowBox[{"newAssoc", "[", "#", "]"}], "[", "\"\<colofour\>\"", 
            "]"}]}], "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"combinations", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{"current", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"found", "=", "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"found", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"found", "=", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"crit", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"newAssoc", "[", 
                 RowBox[{"pair", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                "\"\<colofour\>\"", "]"}], "+", 
               RowBox[{
                RowBox[{"newAssoc", "[", 
                 RowBox[{"pair", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
                "\"\<colofour\>\"", "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"items", "=", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "newAssoc", "]"}], ",", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"current", ",", "#"}], "]"}]}], "&"}]}], "]"}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"newAssoc", "[", "#", "]"}], "[", 
                   "\"\<colofour\>\"", "]"}], "\[Equal]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"newAssoc", "[", 
                    RowBox[{"pair", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                    "\"\<colofour\>\"", "]"}], "-", 
                    RowBox[{
                    RowBox[{"newAssoc", "[", 
                    RowBox[{"pair", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
                    "\"\<colofour\>\"", "]"}]}], ")"}]}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"added", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"added", ",", "items"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"items", "=", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "newAssoc", "]"}], ",", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"current", ",", "#"}], "]"}]}], "&"}]}], "]"}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"newAssoc", "[", "#", "]"}], "[", 
                   "\"\<colofour\>\"", "]"}], "\[Equal]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"newAssoc", "[", 
                    RowBox[{"pair", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                    "\"\<colofour\>\"", "]"}], "+", 
                    RowBox[{
                    RowBox[{"newAssoc", "[", 
                    RowBox[{"pair", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
                    "\"\<colofour\>\"", "]"}]}], ")"}]}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"added", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"added", ",", "items"}], "]"}]}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"pair", ",", "combinations"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"pair", ",", 
            RowBox[{"Length", "[", "added", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "added", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"added", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Length", "[", "added", "]"}], "\[Rule]", "added"}], 
             "}"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"current", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"current", ",", "added"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"found", "=", "True"}]}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"added", "=", 
         RowBox[{"{", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.67128579916072*^9, 3.671285808674655*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"CosyPrint2", "[", "#", "]"}], "&"}], ",", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2", ",", "6", ",", "18", ",", "54", ",", "162", ",", "486", ",", 
       "1458", ",", "4374", ",", "13122", ",", "39366", ",", "487", ",", 
       "13123", ",", "39367", ",", "165", ",", "4377", ",", "39369", ",", 
       "63", ",", "1467", ",", "39375", ",", "39379", ",", "45", ",", "4401", 
       ",", "13149", ",", "87", ",", "1539", ",", "13203", ",", "13231", ",", 
       "245", ",", "1701", ",", "4617", ",", "4647", ",", "1791", ",", "747", 
       ",", "891", ",", "1215", ",", "2193", ",", "2241", ",", "2673", ",", 
       "3403", ",", "6563", ",", "6615", ",", "6723", ",", "7455", ",", 
       "8811", ",", "19685", ",", "19689", ",", "19701", ",", "20457", ",", 
       "21957", ",", "26489"}], "}"}], ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"newAssoc", "[", "#", "]"}], ",", "\"\<comp\>\""}], "]"}]}], 
      "&"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6712883218481374`*^9, 3.6712883308270683`*^9}, {
  3.671288386208929*^9, 3.671288445619698*^9}, {3.671288961447569*^9, 
  3.671288970569954*^9}}],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{
  3.671288450925654*^9, {3.671288948773359*^9, 3.6712889647299423`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CosyPrint2", "[", "#", "]"}], "&"}], ",", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "1", ",", "3", ",", "9", ",", "13", ",", "27", ",", "36", 
        ",", "81", ",", "84", ",", "109", ",", "243", ",", "244", ",", "273", 
        ",", "333", ",", "364", ",", "729", ",", "738", ",", "810", ",", 
        "972", ",", "1062", ",", "2187", ",", "2190", ",", "2214", ",", 
        "2430", ",", "2460", ",", "2917", ",", "3160", ",", "6561", ",", 
        "6562", ",", "6588", ",", "6642", ",", "6670", ",", "7293", ",", 
        "7374", ",", "8757", ",", "8784", ",", "9490", ",", "19683", ",", 
        "19684", ",", "19686", ",", "19692", ",", "19696", ",", "20439", ",", 
        "20448", ",", "21951", ",", "21954", ",", "22708", ",", "26487", ",", 
        "26488", ",", "27246", ",", "28764"}], "}"}], ",", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{
          RowBox[{"newAssoc", "[", "#", "]"}], ",", "\"\<comp\>\""}], "]"}]}],
        "&"}]}], "]"}]}], "]"}], "//", "Length"}]], "Input",
 CellChangeTimes->{
  3.671289463218045*^9, {3.6712896907123938`*^9, 3.67128969321068*^9}}],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{
  3.6712894679143333`*^9, {3.6712896878610163`*^9, 3.671289694757504*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymbolComp", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{"SymbolName", "[", "x", "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{"SymbolName", "[", "y", "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", "\[NotEqual]", "b"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"a", "<", "b"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{"StringDrop", "[", 
        RowBox[{
         RowBox[{"SymbolName", "[", "x", "]"}], ",", "1"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{"StringDrop", "[", 
        RowBox[{
         RowBox[{"SymbolName", "[", "y", "]"}], ",", "1"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"a", "<", "b"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6712924640049305`*^9, 3.671292506699218*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpComp", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"varx", "=", 
       RowBox[{"getAllVariables", "[", "x", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"vary", "=", 
       RowBox[{"getAllVariables", "[", "y", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "varx", "]"}], "\[NotEqual]", 
        RowBox[{"Length", "[", "vary", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", " ", "[", 
        RowBox[{
         RowBox[{"Length", "[", "varx", "]"}], "<", 
         RowBox[{"Length", "[", "vary", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"varx", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"varx", ",", "SymbolComp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vary", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"vary", ",", "SymbolComp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"StringJoin", "[", "varx", "]"}], "<", 
      RowBox[{"StringJoin", "[", "vary", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6712922527680025`*^9, 3.6712923427293057`*^9}, {
  3.671292522262349*^9, 3.6712925255234766`*^9}, {3.6712925565209846`*^9, 
  3.6712926084974303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpressionToTable", "[", "exp_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vals", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Monitor", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"exp", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "//", "Simplify"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "exp", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "exp", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"TableForm", "[", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"vals", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "vals", "]"}]}], "}"}]}], "]"}], ",", 
        "ExpComp"}], "]"}], ",", 
      RowBox[{"TableDirections", "\[Rule]", "Column"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6712922342860327`*^9, 3.6712922490722475`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"Fold", "[", 
    RowBox[{"And", ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"newAssoc", "[", "#", "]"}], "[", "\"\<colofour\>\"", "]"}],
          ">", "0"}], "&"}], ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "newAssoc", "]"}], ",", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{
            RowBox[{"newAssoc", "[", "#", "]"}], ",", "\"\<comp\>\""}], "]"}],
           "&"}]}], "]"}]}], "]"}]}], "]"}], "]"}], "//", 
  "ExpressionToTable2"}]], "Input",
 CellChangeTimes->{{3.6712898780779085`*^9, 3.671289974418708*^9}, {
  3.6714608501568937`*^9, 3.6714608565152903`*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"d1", ">", "0"}]},
     {
      RowBox[{"d2", ">", "0"}]},
     {
      RowBox[{"d3", ">", "0"}]},
     {
      RowBox[{"d4", ">", "0"}]},
     {
      RowBox[{"z", ">", "0"}]},
     {
      RowBox[{
       RowBox[{"d1", "+", "d4"}], "<", "z"}]},
     {
      RowBox[{
       RowBox[{"d2", "+", "d4"}], "<", "z"}]},
     {
      RowBox[{
       RowBox[{"d3", "+", "d4"}], "<", "z"}]},
     {
      RowBox[{"z", "<", 
       RowBox[{"d1", "+", "d2", "+", "d4"}]}]},
     {
      RowBox[{"z", "<", 
       RowBox[{"d1", "+", "d3", "+", "d4"}]}]},
     {
      RowBox[{"z", "<", 
       RowBox[{"d2", "+", "d3", "+", "d4"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "z"}], "<", 
       RowBox[{"d1", "+", "d2", "+", "d3", "+", 
        RowBox[{"2", " ", "d4"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDirections -> Column]]]], "Output",
 CellChangeTimes->{
  3.6712898954482565`*^9, {3.671289933893086*^9, 3.671289981573381*^9}, 
   3.6714608244507227`*^9, 3.671460857891498*^9, 3.6714609229042215`*^9, 
   3.6714631240310097`*^9}]
}, Open  ]]
},
WindowSize->{1104, 749},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 609, 16, 92, "Input"],
Cell[CellGroupData[{
Cell[1192, 40, 471, 10, 31, "Input"],
Cell[1666, 52, 546, 9, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2249, 66, 133, 2, 31, "Input"],
Cell[2385, 70, 6898, 156, 187, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9320, 231, 2231, 52, 272, "Input"],
Cell[11554, 285, 125, 2, 31, "Output"]
}, Open  ]],
Cell[11694, 290, 122, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[11841, 296, 432, 7, 31, "Input"],
Cell[12276, 305, 79, 1, 31, "Output"]
}, Open  ]],
Cell[12370, 309, 94, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[12489, 314, 368, 10, 31, "Input"],
Cell[12860, 326, 780, 13, 52, "Output"]
}, Open  ]],
Cell[13655, 342, 6732, 151, 532, "Input"],
Cell[CellGroupData[{
Cell[20412, 497, 129, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[20566, 503, 229, 6, 23, "Print"],
Cell[20798, 511, 203, 5, 23, "Print"],
Cell[21004, 518, 206, 5, 23, "Print"],
Cell[21213, 525, 207, 5, 23, "Print"],
Cell[21423, 532, 169, 4, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21641, 542, 332, 9, 31, "Input"],
Cell[21976, 553, 120, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22133, 560, 239, 4, 31, "Input"],
Cell[22375, 566, 5524, 124, 113, "Output"]
}, Open  ]],
Cell[27914, 693, 5886, 140, 492, "Input"],
Cell[CellGroupData[{
Cell[33825, 837, 1293, 27, 72, "Input"],
Cell[35121, 866, 122, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35280, 873, 1271, 27, 72, "Input"],
Cell[36554, 902, 124, 2, 31, "Output"]
}, Open  ]],
Cell[36693, 907, 1368, 37, 172, "Input"],
Cell[38064, 946, 1493, 39, 212, "Input"],
Cell[39560, 987, 1321, 36, 92, "Input"],
Cell[CellGroupData[{
Cell[40906, 1027, 781, 22, 52, "Input"],
Cell[41690, 1051, 1550, 53, 206, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
